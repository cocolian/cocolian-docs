---
layout:     source 
title:      "2018-09-25-WeChat"
date:       2018-09-25 12:00:00
author:     None
lines:      148 
tag:       [chat]
---
> 09:29:19  凤凰牌老熊-群管理  
   
请未分享的同学 尽快访问: http://wiki.cocolian.cn/pages/viewpage.action?pageId=4292754  登记分享主题和时间。  本群已满，群主会不定期对群里人员统计，移除未提供分享、长时间潜水不发言的同学。 谢谢大家支持。    群规： http://doc.cocolian.cn/wechat/group/2018/01/01/proposal/  
   
> 09:31:27  地平线-文思-产品  
   
收到。  
   
> 09:31:29  凤凰牌老熊-群管理  
   
本周分享：  9月26日， 周三 ， 分享同学“宇-交行-上海”， 请认领下哈。  9月27日， 周四， @张天辉-饿了么-产品-上海   9月30日 ， 周日， @Tammy-融宝支付-产品-北京   10月1日， 周一，@张海亮-中化-高级JAVA-北京  10月2日，周二， @陈琼-开课啦-产品-杭州    
   
> 09:31:36  吴振方-阿里巴巴-技术专家  
   
收到  
   
> 09:31:47  李凯-潇湘支付-产品-长沙  
   
收到  
   
> 09:31:49  Ting Wang-OTT PAY-PM-Toronto  
   
收到  
   
> 09:31:55  Zero 亨元金融  研发  
   
收到  
   
> 09:31:56  包建宇-小米支付-北京  
   
签到  
   
> 09:32:02  顺强-易付-开发-北京  
   
收到  
   
> 09:32:07  陈琼-开课啦-产品-杭州  
   
收到  
   
> 09:32:10  苑（yuan）亚玮-Ping++  
   
收到  
   
> 09:32:10  王成龙-新浪跨境-研发-上海  
   
收到  
   
> 09:32:14  丹凤-现在支付-产品-武汉  
   
收到  
   
> 09:32:21  micheal 简米 开发  
   
收到  
   
> 09:32:23  广州银典-张伯伦-BOSS  
   
签到  
   
> 09:32:31  wxid_90sbb0ulhrag21  
   
收到  
   
> 09:32:35  程文-永达互金-开发  
   
签到  
   
> 09:32:39  吴杰棣 首展科技 产品经理  
   
收到  
   
> 09:32:40  郭耀武-华海-技术  
   
收到  
   
> 09:32:46  宋炽-斗牛金服-PM-北京  
   
签到  
   
> 09:32:48  mouse-xn-开发-深圳  
   
收到  
   
> 09:32:58  senvon-华腾-架构师  
   
签到  
   
> 09:32:59  lance-货拉拉-开发  
   
收到  
   
> 09:33:02  丁丁-群管理  
   
「凤凰牌老熊-群管理：本周分享：  9月26日， 周三 ， 分享同学“宇-交行-上海”， 请认领下哈。  9月27日， 周四， @张天辉-饿了么-产品-上海   9月30日 ， 周日， @Tammy-融宝支付-产品-北京   10月1日， 周一，@张海亮-中化-高级JAVA-北京  10月2日，周二， @陈琼-开课啦-产品-杭州  」 - - - - - - - - - - - - - - - 大家别签到了，请做分享的同学认领下，做个签到就好了。  
   
> 09:33:03  Daniel-快钱-架构  
   
收到  
   
> 09:33:20  曾卓-长丰集团-架构师-长沙  
   
收到  
   
> 09:33:36  振效+神码+北京  
   
收到  
   
> 09:35:07  zijun-财付通  
   
收到  
   
> 09:37:55  林庆荣-顺信服-技术-广州  
   
收到  
   
> 09:38:11  张海亮-中化-高级JAVA-北京  
   
收到  
   
> 09:38:30  张海亮-中化-高级JAVA-北京  
   
明天确认主题  
   
> 09:38:47  张海亮-中化-高级JAVA-北京  
   
[抱拳]  
   
> 09:42:54  梁燕东-亿付数字-研发  
   
收到  
   
> 09:43:05  郑增远—WIND—攻城狮—上海  
   
收到  
   
> 09:43:23  吴玉林-亿付数字-高级java  
   
收到  
   
> 09:44:50  李晨欢-蚂蚁金服-开发  
   
收到  
   
> 09:45:57  Yang-联拓-研发-北京  
   
收到  
   
> 09:47:52  高天佑-科蓝-产品-北京  
   
收到  
   
> 09:48:12  秋生-联动优势-项目经理  
   
收到  
   
> 09:48:33  胡倩颖-渠道-北京  
   
收到  
   
> 09:50:10  黎明-金投-项目-杭州  
   
收到  
   
> 09:50:30  京东金融-王烨  
   
收到  
   
> 09:50:44  郑宇贤-惠丰-支付产品-广州  
   
收到  
   
> 09:50:54  辉_风控研发_上海  
   
收到  
   
> 09:52:13  刘侨-易贷-北京  
   
收到  
   
> 09:52:18  移联支付-西西-iOS  
   
收到  
   
> 09:52:37  张虎成—云快报—上海–研发  
   
收到  
   
> 09:53:11  吉信科技-紫君-产品  
   
收到  
   
> 09:55:06  杨万新 技术 浙江触角  
   
收到  
   
> 09:56:20  程昱_群管理  
   
收到  
   
> 09:59:30  梁考拉-博时-资金清算-北京  
   
好的  
   
> 09:59:36  李胜勇-永乐-G-北京  
   
收到  
   
> 10:01:28  Eric-Silot-SG  
   
收到  
   
> 10:03:27  Linzr 博思 支付  
   
收到  
   
> 10:07:15  程超-流浪的猴  
   
收到  
   
> 10:09:43  张岩-华恒科技-商务-吉林  
   
收到  
   
> 10:11:27  京东金融-王烨  
   
收到  
   
> 10:15:41  泽西-趋恒-架构师  
   
收到  
   
> 10:51:22  胡伟宏-讯联智付-产品-深圳  
   
收到  
   
> 10:52:57  韩财光  
   
收到  
   
> 11:08:53  支付产品开发交流群  
   
[6367551827@chatroom:
](&amp;lt;sysmsg type=&amp;quot;sysmsgtemplate&amp;quot;&amp;gt;)  
   
> 11:23:02  yongjian-沃支付-产品  
   
收到  
   
> 11:27:21  海建-xtransfer-反洗钱合规  
   
收到  
   
> 11:31:56  el-渣打-后台开发  
   
收到  
   
> 11:41:25  曾卓-长丰集团-架构师-长沙  
   
@凤凰牌老熊-群管理  预约10月29日   讲车联网应用场景与基础架构  
   
> 11:44:57  丁丁-群管理  
   
@曾卓-长丰集团-架构师-长沙 收到  欢迎欢迎  
   
> 11:45:52  凤凰牌老熊-群管理  
   
@曾卓-长丰集团-架构师-长沙  [鼓掌][鼓掌][鼓掌][鼓掌]  
   
> 11:47:35    
   
> 11:47:48  曾卓-长丰集团-架构师-长沙  
   
谢谢 好平台  
   
> 11:52:16  班纳睿-RRD-Java开发-北京  
   
[强][强][强]  
   
> 11:56:25  邵阳_京东商城_Java  
   
多讲点技术架构学习下  
   
> 11:56:56  邵阳_京东商城_Java  
   
保证系统即稳定又快  
   
> 11:57:54  达达-消金-开发  
   
JD内部学习就够了吧  
   
> 16:00:08  达达-消金-开发  
   
请问 节假日跨行对公户之间转账限额多少？有什么渠道可以选择？  
   
> 16:08:11  李燕明-TCL金融-产品-上海  
   
貌似只有银联好点，一般单笔限额1000万。其他支付公司都是垫资，费用贵  
   
> 16:08:51  楚楠-招联-开发-深圳  
   
节假日，走同城结算系统应该也可以的  
   
> 16:11:42  达达-消金-开发  
   
@楚楠-招联-开发-深圳 小城市的同城结算对外开放吗   
   
> 16:12:29  达达-消金-开发  
   
@李燕明-TCL金融-产品-上海 实时转账？ 费用一般多少  
   
> 20:55:31  风兮-Java技术-上海  
   
hello，大家在设计核心账户系统的时候是否真的会考虑乐观锁呢？  
   
> 20:56:03  胡桥  
   
肿么了?  
   
> 20:57:57  钟鸿敏-CF-技术VP-深圳  
   
账务层不会，乐观锁可不乐观  
   
> 21:00:41  风兮-Java技术-上海  
   
但是从理想角度想同一账户交易并发的可能性不大  
   
> 21:01:12  风兮-Java技术-上海  
   
就是由此想法，因为我们通常都是悲观锁  
   
> 21:03:16  风兮-Java技术-上海  
   
因为大家都是说用悲观锁了，反而很少有人真正的论证乐观锁的不可靠性了，都是从理论上不建议乐观锁。所以想咨询大佬们都看法[呲牙]  
   
> 21:06:13  钟鸿敏-CF-技术VP-深圳  
   
![2018-09-25 21:06:13](http://static.cocolian.cn/img/20180925_210613.png) 
   
> 21:07:28  钟鸿敏-CF-技术VP-深圳  
   
现在很多缓存方案下，乐观锁的意义已经不大了  
   
> 21:09:34  钟鸿敏-CF-技术VP-深圳  
   
我觉得乐观锁是解放前的产物了，那时的中间件或者解决方案并没那么丰富  
   
> 21:11:40  风兮-Java技术-上海  
   
[OK]，我再学习学习??   
   
> 21:20:50  李燕明-TCL金融-产品-上海  
   
@达达-CYWB-开发?节假日支付公司一般5元/笔，银联的要谈，给额度，量大免。  
   
> 21:21:28  达达-消金-开发  
   
@李燕明-TCL金融-产品-上海?好的，谢谢  
   
> 21:21:43  张学鸿-北京-研发-民金所  
   
@钟鸿敏-CF-技术VP-深圳?牛 几和月前的还保留着  
   
> 21:23:27  右军-蚂蚁金服-成都  
   
回到锁的本质，是对于热点资源的并发。相对悲观锁而言，乐观锁机制采取了更加宽松的加锁机制。比如数据库使用version， 还有更宽松的使用 符合某种where条件的场景，比如预算使用，业务上不关注预算使用请求的 绝对顺序，但是要保障不透支。  
   
> 21:25:49  风兮-Java技术-上海  
   
嗯嗯，可能我之前想的太理想了  
   
> 21:29:08  钟鸿敏-CF-技术VP-深圳  
   
@张学鸿-北京-研发-民金所?聊天记录搜一下就有了  
   
> 21:36:54  钟鸿敏-CF-技术VP-深圳  
   
@右军-蚂蚁金服-成都?其实和顺序无关，乐观锁要保障的是我改动的这条没被其它线程改动过，举个例，账户上20块钱，有一笔8块和9块的并发请求，不管是悲观锁还是乐观锁，谁先到都无所谓，但乐观锁肯定有一条是失败  
   
> 21:38:20  张学鸿-北京-研发-民金所  
   
@钟鸿敏-CF-技术VP-深圳?哦哦  
   
> 21:38:37  钟鸿敏-CF-技术VP-深圳  
   
如果要保障这种失败不传递到业务层，就要引入很多其它设计，得不偿失还把逻辑搞复杂了  
   
> 21:39:12  右军-蚂蚁金服-成都  
   
乐观锁要保障的是我改动的这条没被其它线程改动过，看宽松度。  
   
> 21:39:25  右军-蚂蚁金服-成都  
   
我说的预算那种情况， 允许更宽松  
   
> 21:43:27  钟鸿敏-CF-技术VP-深圳  
   
预算一般都会涉及到账户，只要涉及到账户，乐观锁并不合适，说实在，我现在很难想到还能用乐观锁的场景，除了一种，就是多个请求竞争一个资源的情况，这种情况下允许大部分请求失败，像秒杀，但现在秒杀不会这样设计  
   
> 21:44:42  右军-蚂蚁金服-成都  
   
我们在预算按先拆分，再乐观设计的  
   
> 21:47:46  程琳_群管理  
   
请教一下，针对同步记账（仅虚户变动，不涉及出入金）如余额支付或余额支付退款，支付核心系统和账务系统会做内部对账吗？  
   
> 21:48:41  胡桥  
   
@程琳_群管理?那个好像叫系统间对账，专业名词证证相符[坏笑][坏笑][坏笑][坏笑]  
   
> 21:49:09  程琳_群管理  
   
是的，这种会做内部对账吗？  
   
> 21:49:19  胡桥  
   
一般都是由技术保证，你掉单，数据变异，技术不过关呀[坏笑][坏笑][坏笑][坏笑]  
   
> 21:49:48  程琳_群管理  
   
那就是不对账，以同步记账结果为准？  
   
> 21:50:06  胡桥  
   
以会计里面为准  
   
> 21:50:35  胡桥  
   
还有一个环节是账务核算，不同的场景有不同的核算办法  
   
> 21:51:10  钟鸿敏-CF-技术VP-深圳  
   
@右军-蚂蚁金服-成都 没明白，有机会普及下，感觉拆分只是分散多个锁，但单个锁的设计并没有改变  
   
> 21:52:12  右军-蚂蚁金服-成都  
   
回聊  
   
> 21:52:58  程琳_群管理  
   
我的问题是 虚户之间的转账这种，是以同步记账结果为准后需要做交易系统和账务系统日终 状态一致性的检查吗？（假设没有会计系统）  
   
> 21:54:16  夏志强~快付通~技术经理  
   
需要  
   
> 21:54:24  胡桥  
   
最少要保证和订单对一下  
   
> 21:54:39  钟鸿敏-CF-技术VP-深圳  
   
我们叫系统间对账，只对交易层面  
   
> 21:56:09  程琳_群管理  
   
我还有一个问题：所有跟账务之间的交互，中间都要经过支付核心（或交易核心），而不是业务系统直接跟账务交互的初衷，是因为异常情况的补偿机制直接支付核心统一处理吗？  
   
> 21:57:00  程琳_群管理  
   
「 钟鸿敏-CF-技术VP-深圳: 我们叫系统间对账，只对交易层面 」 - - - - - - - - - - - - - - - 如果不做对账，会有什么问题，我听说目前没做过对账，并且人工调账的频次也不高，不知真假[冷汗]  
   
> 21:57:51  钟鸿敏-CF-技术VP-深圳  
   
这个我们做过，当初是为了统一入口，最早我们也是各业务系统直接调账务系统，后来改到支付核心  
   
> 21:58:49  程琳_群管理  
   
「 钟鸿敏-CF-技术VP-深圳: 这个我们做过，当初是为了统一入口，最早我们也是各业务系统直接调账务系统，后来改到支付核心 」 - - - - - - - - - - - - - - - 改的初衷是降低各个业务系统针对异常处理的开发量？  
   
> 21:58:52  钟鸿敏-CF-技术VP-深圳  
   
不做对账，就是出现掉单或状态不一致时，不能发现，要等客户反映才知道  
   
> 21:59:10  大圣-黄金钱包-开发  
   
@钟鸿敏-CF-技术VP-深圳?应该是这种乐观锁吧，where amount - $amount &amp;gt;= 0  
   
> 21:59:59  大圣-黄金钱包-开发  
   
无所谓顺序，但是不能超支  
   
> 22:00:11  钟鸿敏-CF-技术VP-深圳  
   
异常的处理并没有减少啊，只是调用账户的入口统一了，我觉得这种设计没有绝对的对错  
   
> 22:01:24  钟鸿敏-CF-技术VP-深圳  
   
@大圣-黄金钱包-开发 上述的两种锁设计，都不会有超支，无论余额足还是不足  
   
> 22:02:23  钟鸿敏-CF-技术VP-深圳  
   
但余额足的情况下，乐观锁的失败率会高  
   
> 22:02:26  程琳_群管理  
   
「 钟鸿敏-CF-技术VP-深圳: 异常的处理并没有减少啊，只是调用账户的入口统一了，我觉得这种设计没有绝对的对错 」 - - - - - - - - - - - - - - - 统一入口之后，就由支付核心统一处理异常逻辑了，各个业务系统就不用单独处理了。这不是减轻了业务系统的开发量吗？  
   
> 22:03:36  钟鸿敏-CF-技术VP-深圳  
   
支付核心不是最上层业务系统啊，支付核心就算统一处理也不能把异常吃了啊，一般情况都要抛给上面业务系统的  
   
> 22:03:59  程琳_群管理  
   
好吧  
   
> 22:06:45  钟鸿敏-CF-技术VP-深圳  
   
只有直接业务系统才知道发生异常后业务要如何处理，有些需要重试，有些不需要，有些可能会有其它处理逻辑，不同业务系统处理方式不一样，中间系统无权决定  
   
> 22:21:30  广州银典-张伯伦-BOSS  
   
我之前接触过拉X拉的核心交易系统，POSP的那套，在处理核心交易业务逻辑之前，专门有套很牛X的风控模块，规避交易业务异常现象  
   
> 22:23:04  wood-通联-技术  
   
他们的风控系统不是邦盛的吗？  
   
> 22:23:18  广州银典-张伯伦-BOSS  
   
后来与邦盛有合作  但不是全部    
   
> 22:23:26  广州银典-张伯伦-BOSS  
   
他们有自己的风控模型  很强大的   
   
> 22:23:34  广州银典-张伯伦-BOSS  
   
深圳研发中心有一支专业团队在负责  
   
> 22:24:06  广州银典-张伯伦-BOSS  
   
到去年的时候，他们还是直联银行的POS发卡侧   真牛X   我都汗了  
   
> 22:24:39  wood-通联-技术  
   
没有走银联？  
   
> 22:24:43  wood-通联-技术  
   
真的假的  
   
> 22:24:51  wood-通联-技术  
   
这么牛？  
   
> 22:24:54  wood-通联-技术  
   
举报啊  
   
> 22:24:58  wood-通联-技术  
   
你就发了  
   
> 22:25:13  广州银典-张伯伦-BOSS  
   
跟老孙都这么熟了  不好意思举报啊  
   
> 22:25:25  广州银典-张伯伦-BOSS  
   
不过小银行比较多   还有很多家  大银行就很少了  
   
> 22:25:33  wood-通联-技术  
   
分给老孙一半啊  
   
> 22:25:46  wood-通联-技术  
   
没啥  
   
> 22:25:49  广州银典-张伯伦-BOSS  
   
还买过老孙的签名书籍[坏笑]  
   
> 22:26:13  wood-通联-技术  
   
不是群里的那个老孙吧  
   
> 22:26:45  广州银典-张伯伦-BOSS  
   
孙陶然同学  
   
> 22:27:15  wood-通联-技术  
   
群里的老孙是不是就是本尊啊  
   
> 22:38:29  程琳_群管理  
   
@钟鸿敏-CF-技术VP-深圳?了解，感谢钟总[抱拳][抱拳][抱拳]  
   
