---
layout:     source 
title:      "2018-09-07-WeChat"
date:       2018-09-07 12:00:00
author:     None
lines:      199 
tag:       [chat]
---
> 00:15:12  李伟锋-51信用卡-开发  
   
ok  
   
> 07:45:22  右军-蚂蚁金服-成都  
   
余额宝技术创新之道  
   
> 07:45:23  右军-蚂蚁金服-成都  
   
[余额宝：国民基金的大规模服务化的技术创新之道
](http://mp.weixin.qq.com/s?__biz=MzIxMzEzMjM5NQ==&amp;amp;amp;mid=2651030157&amp;amp;amp;idx=1&amp;amp;amp;sn=139bb9a951095ebfff0b53a0c501cc5e&amp;amp;amp;chksm=8c4c5789bb3bde9fc39812bf528dacef37f2ef93d4d9938d4d9b079955bf565c11c2a5ab6734&amp;amp;amp;mpshare=1&amp;amp;amp;scene=1&amp;amp;amp;srcid=0907A0PzZRWBYhN2xmvkylYw#rd)  
   
> 08:02:25  上海-上海中钢银联通-董路-技术  
   
[强]  
   
> 08:02:36  刘小龙~金融工场~技术经理～北京  
   
[强]  
   
> 08:07:26  丁爱民-58-开发  
   
余额宝的收益降到了2.7%[撇嘴]  
   
> 09:28:55  顾文烨―上海银行―产品―上海  
   
3.16%  
   
> 09:29:40  阿良-越亮传奇-开发  
   
3.048%  
   
> 09:30:09  顾文烨―上海银行―产品―上海  
   
哦，背后是九个基金  
   
> 09:30:17  顾文烨―上海银行―产品―上海  
   
每人对应的组合不一样的  
   
> 09:32:29  拉卡拉-市场-老孙  
   
银行现在不差钱  
   
> 09:32:33  拉卡拉-市场-老孙  
   
流动性差  
   
> 09:32:39  拉卡拉-市场-老孙  
   
所以价格就低  
   
> 09:45:06  李燕明-TCL金融-产品-上海  
   
不好意思发求助，有没有陆家嘴附近的大佬，谁有阿里云幕布借用拍照[捂脸]，邮寄申请来不及了  
   
> 09:49:58  李燕明-TCL金融-产品-上海  
   
[捂脸]我在上海  
   
> 11:12:30  双乾支付-技术总监-韩伟  
   
P上去：）  
   
> 11:15:11    
   
> 12:11:48  哈哈贷-王信威  
   
P不行吧  
   
> 12:12:29  哈哈贷-王信威  
   
之前做p过，一直过不了，没办法最后还是做了  
   
> 14:06:36    
   
> 14:08:03  Linzr 博思 支付  
   
各位大佬，项目机遇springcloud，自动化测试有没有好的推荐  
   
> 14:10:40  李秀刚-TRHUI-鼓励师  
   
过来厦门吧  
   
> 14:10:47  李秀刚-TRHUI-鼓励师  
   
[坏笑]  
   
> 14:16:02  丁丁-群管理  
   
今天请到一位朋友，@鞠骞-亮昕-研发    给大家做分享，主题是 “某小贷客户账户系统设计” 开始时间为【15:00】；欢迎欢迎[鼓掌][鼓掌][鼓掌]！（注： 1.嘉宾分享期间其他人不要发言打断嘉宾分享。2.分享完成后请大家积极补充和提问；3.烦请打“签到”，做签到，谢谢！)  
   
> 14:16:05  丁丁-群管理  
   
欢迎欢迎[鼓掌][鼓掌][鼓掌]  
   
> 14:16:07  丁丁-群管理  
   
签到  
   
> 14:16:17  百联-田浩沛  
   
签到  
   
> 14:16:25  Codefor-YMT-TechLead-BJ  
   
签到  
   
> 14:16:25  杨杰-康城投资-开发-上海  
   
签到  
   
> 14:16:31  巡山大王  
   
签到  
   
> 14:16:32  XZ-中金-产品  
   
签到  
   
> 14:16:48  盛-中科金服-研发  
   
签到  
   
> 14:16:56  赵八卷 SUNMI 上海  
   
签到  
   
> 14:17:06  梁文辉-中科软-需求-北京  
   
签到  
   
> 14:17:27  弋碎-国美-产品  
   
签到  
   
> 14:17:39  吕波-融投世界科技-技术总监-沈阳  
   
签到  
   
> 14:17:43  鞠骞-亮昕-研发  
   
我这边整理下，稍后进行分享，大家互相交流哈  
   
> 14:17:43  曾卓-长丰集团-架构师-长沙  
   
签到  
   
> 14:17:53  王晓强-绿地金控-技术-上海  
   
签到  
   
> 14:17:57  Linzr 博思 支付  
   
签到  
   
> 14:18:54  明函-智仁科技-黑龙江-市场  
   
签到  
   
> 14:19:29  黄福祥-ETC车宝-鼓励师-广州  
   
签到  
   
> 14:20:07  王宁-杉德-开发  
   
签到。  
   
> 14:20:31  曹超  
   
签到  
   
> 14:20:42  冯忠旗-付钱拉-技术  
   
签到  
   
> 14:21:16  黎明-金投-项目-杭州  
   
签到  
   
> 14:21:17  邹刘名-百联-研发-上海  
   
签到  
   
> 14:21:31  sophia-教育-产品-北京  
   
签到  
   
> 14:21:42  上海-上海中钢银联通-董路-技术  
   
签到  
   
> 14:21:47  lance-货拉拉-开发  
   
签到  
   
> 14:22:06  林安迪-商务-电商分账宝  
   
签到  
   
> 14:22:19  京东金融-王烨  
   
签到  
   
> 14:24:21  顾文烨―上海银行―产品―上海  
   
签到  
   
> 14:24:30  Elin-昊链-产品经理-广州  
   
签到  
   
> 14:25:14  深圳-平安-产品-黄朋英  
   
签到  
   
> 14:27:15  赵业招-JD-技术-上海  
   
签到  
   
> 14:28:12  hgwym-传化支付-技术经理  
   
签到  
   
> 14:29:56  Sunick-赢时胜-技术-长沙  
   
签到  
   
> 14:30:03  班纳睿-RRD-Java开发-北京  
   
签个到  
   
> 14:30:39  张杨-航天电子-研发-北京  
   
签到  
   
> 14:31:00  周胜-贝络-产品-北京  
   
签到  
   
> 14:31:26  王月卿-群管理  
   
签到  
   
> 14:32:05  张桢-联想商城支付  
   
签到  
   
> 14:32:27  连杰鑫-德比软件VP -上海  
   
签到  
   
> 14:32:41    
   
> 14:32:54  hgwym-传化支付-技术经理  
   
[惊恐]  
   
> 14:34:10  夜月沉星-gtxy-产品-福州  
   
签到  
   
> 14:36:14  未来酱 群管理  
   
签到  
   
> 14:36:30  杜雷-生物认证支付-技术  
   
签到  
   
> 14:38:10  利平--群管理  
   
签到  
   
> 14:39:53  胡倩颖-渠道-北京  
   
签到  
   
> 14:42:29  郭耀武-华海-技术  
   
签到  
   
> 14:42:38  海建-xtransfer-反洗钱合规  
   
签到  
   
> 14:44:00  丹丹-中移信息-产品  
   
签到  
   
> 14:44:54  帅慧-数据-产品  
   
签到  
   
> 14:45:24  十年砍柴-元年-产品-上海  
   
签到  
   
> 14:45:39  terrfly_待业_研发  
   
签到  
   
> 14:45:40  星枫-一下科技-研发经理-北京  
   
签到  
   
> 14:45:50  陈节明-在途-技术  
   
签到  
   
> 14:47:51  Seven~乾道~产品~北京  
   
签到  
   
> 14:50:06  苑（yuan）亚玮-Ping++  
   
签到  
   
> 14:50:21  风兮-Java技术-上海  
   
签到  
   
> 14:51:49  Cc老曹-英之泰-技术  
   
签到  
   
> 14:52:02  smartwave-开科支付-成都  
   
签到  
   
> 14:53:51  永明-云账户-开发-北京  
   
签到  
   
> 14:54:49  高天佑-科蓝-产品-北京  
   
签到  
   
> 14:56:08  鞠骞-亮昕-研发  
   
大家好，今天给大家分享的是《某小贷公司的客户账户系统设计》。首先，我们来看下这个系统包含哪些领域： 如下图所示:   
   
> 14:56:36  老汪-阿尔法-鼓励师-江苏  
   
签到  
   
> 14:56:45  鞠骞-亮昕-研发  
   
![2018-09-07 14:56:45](http://static.cocolian.cn/img/20180907_145645.png) 
   
> 14:57:14  鞠骞-亮昕-研发  
   
我也会分别介绍每个服务的职责，以及包含的内容.  
   
> 14:57:31  andyqian  
   
1. 客户服务 简单的来说，用户从app注册成为我们的一个客户，就会通过该服务进行保存基本信息。该服务主要做的事情有：保存客户的基本信息，其中就包括客户基本信息，地址，联系人信息,  交易密码等。  
   
> 14:57:41  鞠骞-亮昕-研发  
   
![2018-09-07 14:57:41](http://static.cocolian.cn/img/20180907_145741.png) 
   
> 14:57:53  yongjian-沃支付-产品  
   
签到  
   
> 14:57:57  鞠骞-亮昕-研发  
   
2. 账户服务从宏观上来说，账户服务的职责主要分为：账户结构，账户余额，额度控制三个模块。  
   
> 14:58:12  鞠骞-亮昕-研发  
   
![2018-09-07 14:58:12](http://static.cocolian.cn/img/20180907_145812.png) 
   
> 14:58:19  csp-架构-深圳  
   
签到  
   
> 14:58:34  鞠骞-亮昕-研发  
   
2.1 账户结构采用的是树形结构。如下图所示:   
   
> 14:59:04  鞠骞-亮昕-研发  
   
![2018-09-07 14:59:04](http://static.cocolian.cn/img/20180907_145904.png) 
   
> 14:59:18  鞠骞-亮昕-研发  
   
2.2  账户余额: 主要记录的是，用户借了多少钱，还了多少，还有多少未还。有哪些费用未还的记录。  
   
> 14:59:29  鞠骞-亮昕-研发  
   
2.3 额度控制: 这个里面有个最重要的概念，就是可用额度的计算。简单的可以认为: (授信额度-已使用的额度-冻结额度- = 可用额度)。当然，实际中还有很多因素。  
   
> 14:59:50  鞠骞-亮昕-研发  
   
![2018-09-07 14:59:50](http://static.cocolian.cn/img/20180907_145950.png) 
   
> 15:00:08  鞠骞-亮昕-研发  
   
3. 产品服务，这里的产品服务指的是 现金贷产品，现金分期，消费分期产品等。  
   
> 15:00:45  鞠骞-亮昕-研发  
   
4. 定价服务。主要是计价的服务，例如服务费获取，举个栗子：用户借款100块钱。多少服务费。就是从这个服务来的。 5. 合约服务。 指用户开通一个产品时，自动给他开通的合约，这个是用户无感知的。可以看成是用户，产品，的关联表。 6. 协议服务，这个是用户能看到的，例如: 注册时的注册协议， 借款时的借款协议。后端以PDF电子合同存储到文件服务中。 7. 终端服务，主要保存用户的设备终端，比如: 用户用Android的手机，安装后，我们认为是一个终端。这里不在详细讲解。  
   
> 15:02:00  鞠骞-亮昕-研发  
   
由于准备的不太充分，分享就是这些。大家有什么问题，可以随时问我  
   
> 15:02:45  丁丁-群管理  
   
> 15:03:31  smartwave-开科支付-成都  
   
@鞠骞-亮昕-研发  谢谢前辈分享， 请教一下 在小贷系统里面的账户结构里面涉及的多个账户， 白天的时候发生交易在小贷系统里面记的是台账， 日终与核心做一次科目的轧差记账吗？  
   
> 15:03:59  永明-云账户-开发-北京  
   
@鞠骞-亮昕-研发 ,问句题外话啊，这套系统有使用总线系统吗？  
   
> 15:04:08    
   
> 15:04:18  永明-云账户-开发-北京  
   
SOA  
   
> 15:04:45  鞠骞-亮昕-研发  
   
@永明-云账户-开发-北京 不是的  
   
> 15:05:45  鞠骞-亮昕-研发  
   
@smartwave-开科支付-成都 可以这么理解，  
   
> 15:05:53  鞠骞-亮昕-研发  
   
http://note.youdao.com/noteshare?id=fd2ab4046dae24d1b0081e60d65b2dc6&amp;amp;sub=33CECA53500A44418B27A3F8669C2DAC  
   
> 15:06:20  鞠骞-亮昕-研发  
   
大家可以看下这个笔记，里面可能更详细些  
   
> 15:08:55  smartwave-开科支付-成都  
   
再请教一下 ，当用户发生借款时，红色部分的数量是否根据用户选的分期数来决定的。[呲牙] 还是说 账户数量是固定的，只不过用户选择的期数觉得有多少个账户里面存在交易  
   
> 15:08:55  smartwave-开科支付-成都  
   
![2018-09-07 15:08:55](http://static.cocolian.cn/img/20180907_150855.png) 
   
> 15:09:48  鞠骞-亮昕-研发  
   
是用户选择的，  
   
> 15:10:21  鞠骞-亮昕-研发  
   
用户选择多少期，业务系统给过来开几个账户就好了，账户这边提供的是原子操作，  
   
> 15:11:03  smartwave-开科支付-成都  
   
嗯嗯  多谢分享、。[抱拳]  
   
> 15:11:14  鞠骞-亮昕-研发  
   
根据产品不同，开的账户也不同。例如: 现金贷产品，只开一个，分期产品，就是多个了  
   
> 15:12:54  涂智明-科蓝-开发-北京  
   
签到  
   
> 15:19:09  永明-云账户-开发-北京  
   
1800分三个分期，还完第一个后，它的可使用额度是 +600，还是？  
   
> 15:23:21    
   
> 15:23:55  鞠骞-亮昕-研发  
   
其实是分为两种场景的。1. 授信额度可重复使用 。例如: 你申请时，授信2000。 你用了1000。还了1000。你还能用2000。 2. 授信额度不可重复使用。 例如: 授信你得到2000。 你用了1000。 还了1000。 这时只有1000可用。  
   
> 15:30:30  永明-云账户-开发-北京  
   
额  
   
> 15:37:48  程德明-百信银行-支付技术经理  
   
大佬们，有接过银联全渠道的吗？有个问题想请教，T+0日交易发到银联后，银联返回交易状态未明，T+1日对账文件里也没有这笔流水。请问有办法能知道这笔交易的状态吗？已经咨询过银联，银联回复的很官方：以对账文件为准。但是我们也不敢根据T+1日对账文件没有流水就置交易失败。  
   
> 15:38:54  赞同-张铁强  
   
完全可以啊，对账以银联文件为准的  
   
> 15:39:07  北京一张泽雄  
   
为什么不敢处理成失败？  
   
> 15:39:42  北京一张泽雄  
   
收款交易没有资金风险  
   
> 15:40:18  程德明-百信银行-支付技术经理  
   
有没有这种可能：银联T+2日给的对账文件里又有这笔流水？  
   
> 15:40:34  程德明-百信银行-支付技术经理  
   
是付款交易 @北京一张泽雄  
   
> 15:40:40    
   
> 15:41:34  smartwave-开科支付-成都  
   
收款置为失败，可能会长款  
   
> 15:42:10  程德明-百信银行-支付技术经理  
   
恩恩  
   
> 15:42:12  杨秋实-佳禾集团-产品总监  
   
@程德明-百信银行-支付技术经理 有可能你们的日切时间跟银联的没有对应上。  
   
> 15:43:31  程德明-百信银行-支付技术经理  
   
是的，不过这笔交易是中午12点的，应该可以排除日切的可能性 @杨秋实-佳禾集团-产品总监  
   
> 15:43:34  杨秋实-佳禾集团-产品总监  
   
例如银联日切时间是23点，你们是24点。  
   
> 15:44:04  smartwave-开科支付-成都  
   
代收置为失败 可能比较暴力 但是存在长款的情况，代付不能置为失败  
   
> 15:44:41    
   
> 15:44:43  杨秋实-佳禾集团-产品总监  
   
如果确定服务器时间准确，那就可以置为失败了。  
   
> 15:44:45  北京一张泽雄  
   
银联已经说的很清楚了  
   
> 15:44:53  地平线-文思-产品  
   
这种交易，估计要等上2-3天再看。  
   
> 15:44:58  北京一张泽雄  
   
对账单上没有的，肯定就是失败交易了  
   
> 15:45:33  北京一张泽雄  
   
一般T+1日就可以了  
   
> 15:45:37  地平线-文思-产品  
   
我们遇到过20分钟后银联才收到的，如果跨天就会出麻烦。  
   
> 15:46:47  北京一张泽雄  
   
跨天也不可能跨T+1  
   
> 15:47:09  smartwave-开科支付-成都  
   
@北京一张泽雄 不一定啊 可能就是因为系统不一样 ， 我发送交易过去的时候在我系统是T日，但是银联收到的时候他的时间是T+1日 那么它就应该在T+2的对账文件中  
   
> 15:47:34  北京一张泽雄  
   
只不过你是T+2才收到对账单  
   
> 15:47:54    
   
> 15:48:05  北京一张泽雄  
   
这个逻辑是没有问题的  
   
> 15:48:28  地平线-文思-产品  
   
那么就是等到t+2就可以确认了。  
   
> 15:55:03  hgwym-传化支付-技术经理  
   
一般交易最好避开银行的日切点  
   
> 16:09:02  李燕明-TCL金融-产品-上海  
   
最好23:00到次日6:00批量期间交易都关掉，尤其是消金半夜借款多半是赌博输了，风险大[奸笑]  
   
> 18:56:52  清和-产品-深圳  
   
请问一下大家，银联交易渠道中的“批量文件系统”，是个什么鬼系统啊[捂脸]  
   
> 19:14:53  高天佑-科蓝-产品-北京  
   
跑批文件呗  
   
> 19:26:32  清和-产品-深圳  
   
什么场景会出现这个啊？  
   
> 19:27:53  鞠骞-亮昕-研发  
   
数据最终一致性补偿算是一个场景  
   
> 22:34:18  达达-消金-开发  
   
@鞠骞-亮昕-研发?现金贷和现金分期不是一码事吗  
   
> 22:34:42  鞠骞-亮昕-研发  
   
不是的，  
   
> 22:36:38  胡桥  
   
一个有标的物，一个没有标的物  
   
> 22:37:27  鞠骞-亮昕-研发  
   
光从产品形态上看，可以简单理解为，现金贷是单期的，分期是多期的。开通条件，定价规则完全不一样。  
   
> 22:37:31  胡桥  
   
不是叫消费分期么，怎么叫现金分期  
   
> 22:38:23  鞠骞-亮昕-研发  
   
消费分期和现金分期也是两个产品[捂脸]  
   
> 22:38:38  胡桥  
   
哦，我搞错了  
   
> 22:38:52  胡桥  
   
搬个小板凳  
   
> 22:40:01  鞠骞-亮昕-研发  
   
消费分期可以看做买手机分期付款。不一样的是，我一次性借给你，你分为不同期数还我  
   
> 22:40:34  鞠骞-亮昕-研发  
   
现金分期就是，我直接给你1800块，你分三次还我，  
   
> 22:40:48  鞠骞-亮昕-研发  
   
简单可以这么理解  
   
> 22:42:41  鞠骞-亮昕-研发  
   
现金分期，你得到是钱。消费分期得到的是物。  
   
> 22:44:30  胡桥  
   
不就是 等额本息么  
   
> 22:44:47  胡桥  
   
或者等额本金  
   
> 22:45:44  鞠骞-亮昕-研发  
   
有点像。不完全是  
   
> 22:55:20  达达-消金-开发  
   
现金贷就是一期的现金分期喽？  
   
> 22:56:24  胡桥  
   
我就知道这几种，拍个照  
   
> 22:59:23  鞠骞-亮昕-研发  
   
光从期数这个角度可以这么理解，但是其开通条件，授信额度，服务费，产品配置是完全不一样的  
   
> 22:59:24  深圳-平安-产品-黄朋英  
   
消费分期和现金分期区别是用户在前者拿到的是商品，商家和金融机构结算；现金分期是用户直接拿到钱，没有商家这一环  
   
> 22:59:31  胡桥  
   
![2018-09-07 22:59:31](http://static.cocolian.cn/img/20180907_225931.png) 
   
> 23:00:09  胡桥  
   
@深圳-平安-产品-黄朋英?就是受托支付呀  
   
> 23:00:35  鞠骞-亮昕-研发  
   
消费分期是用户在前者拿到的是商品，商家和金融机构结算；现金贷和现金分期是用户直接拿到钱，没有商家这一环  
   
> 23:00:47  鞠骞-亮昕-研发  
   
这样修改后是对的  
   
> 23:04:38  深圳-平安-产品-黄朋英  
   
想问下为啥账户按期数划分  
   
> 23:05:15  深圳-平安-产品-黄朋英  
   
是否为了满足一期子账户中会有多笔还款交易的场景  
   
> 23:05:40  深圳-平安-产品-黄朋英  
   
以前有碰过一期一千块，用户分多次还款  
   
> 23:06:06  深圳-平安-产品-黄朋英  
   
![2018-09-07 23:06:06](http://static.cocolian.cn/img/20180907_230606.png) 
   
> 23:06:14  鞠骞-亮昕-研发  
   
可以的，这个在账户余额里面有记录  
   
> 23:07:31  深圳-平安-产品-黄朋英  
   
这种拆分账户的出发点是啥？大神  
   
> 23:07:34  深圳-平安-产品-黄朋英  
   
?? ??   
   
> 23:08:21  达达-消金-开发  
   
@深圳-平安-产品-黄朋英?你们没拆分是怎么玩的  
   
> 23:08:33  鞠骞-亮昕-研发  
   
![2018-09-07 23:08:33](http://static.cocolian.cn/img/20180907_230833.png) 
   
> 23:10:09  鞠骞-亮昕-研发  
   
这样拆分，便于：还款计划，以及每期还款的本金，利息等  
   
> 23:11:20  鞠骞-亮昕-研发  
   
如果在一起的话，还款计划，销账等操作，不太便于管理。  
   
> 23:11:47  深圳-平安-产品-黄朋英  
   
明白了  
   
> 23:12:14  鞠骞-亮昕-研发  
   
嗯嗯  
   
> 23:13:20  深圳-平安-产品-黄朋英  
   
@达达-消金-开发?我之前的公司也是这么拆分，只不过没有系统化的概念，学习了  
   
> 23:13:34  鞠骞-亮昕-研发  
   
如果在一期内，用户还多次，余额表里面会记录的，还了多少钱，还有多少没还。  
   
> 23:14:38  深圳-平安-产品-黄朋英  
   
嗯呢  
   
> 23:14:39  鞠骞-亮昕-研发  
   
还有在还款的时候，也是有先后顺序的，先还服务费，再还逾期费，等等，最后还本金  
   
> 23:17:33  深圳-平安-产品-黄朋英  
   
你们这个还款冲账顺序会做多种选择，在新增金融产品时关联？  
   
> 23:18:21  深圳-平安-产品-黄朋英  
   
最后是本金的顺序的话贷后和客服要和用户解释  
   
> 23:20:10  鞠骞-亮昕-研发  
   
对的，其实在借款时，就会显示有多少服务费，逾期后按照多少收取，所以还款的时候，用户也能看到  
   
