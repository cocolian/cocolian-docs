---
layout:     source 
title:      "2018-10-28-WeChat"
date:       2018-10-28 12:00:00
author:     bingye-滴滴-国际化-北京
lines:      46 
tag:       [chat]
---
> 00:11:08  姜桥-摩拜单车-技术  
   
[微软正式完成对 GitHub 的收购!!!
](http://mp.weixin.qq.com/s?__biz=MzU3NDY4NzQwNQ==&amp;amp;amp;mid=2247484025&amp;amp;amp;idx=1&amp;amp;amp;sn=1d4b84177d2ecb94525c546f880d40eb&amp;amp;amp;chksm=fd2fd3bbca585aada62834bd02f95fb4fad0644e7e1c7075f7c07cc55163eb07102d06564df9&amp;amp;amp;mpshare=1&amp;amp;amp;scene=1&amp;amp;amp;srcid=1028mokcDHpvNL3zoqusaBjs#rd)  
   
> 20:35:22  丁丁-群管理  
   
今天请到一位朋友，@bingye-滴滴-国际化-北京 ，主题是 “PHP的单元测试及web的一种测试思路 ” 开始时间为【20:45】；欢迎欢迎[鼓掌][鼓掌][鼓掌]！（注： 1.嘉宾分享期间其他人不要发言打断嘉宾分享。2.分享完成后请大家积极补充和提问；3.烦请打“签到”，做签到，谢谢！)  
   
> 20:35:34  丁丁-群管理  
   
欢迎欢迎[鼓掌]  
   
> 20:35:38  丁丁-群管理  
   
签到  
   
> 20:35:41  micheal 简米 开发  
   
签到  
   
> 20:36:16  吴振方-阿里巴巴-技术专家  
   
签到  
   
> 20:36:25  鱼筱雨–来米发–研发部  
   
签到  
   
> 20:36:26  张天辉-饿了么-产品-上海  
   
签到  
   
> 20:36:36  冷兴孜-渠道支付-研发  
   
签到  
   
> 20:36:54  辉_风控研发_上海  
   
签到  
   
> 20:37:01  bingye-滴滴-国际化-北京  
   
大家好，接下来与大家分享下我PHP方面的单测经历。 我11年就开始接触PHP单测，那时候还是3.x版本，现在PHPUnit都已经到7.x了. 当时，需要安装一堆lib，放到include_path里，现在都变成一个文件，下载就能用了，方便很多。  
   
> 20:37:02  bingye-滴滴-国际化-北京  
   
我接触过多种业务的单测，以及YAF, Yii, CI这三个框架的单测。 深感框架对PHP单测的影响很大，主要是因为不同框架的autoload方式都不一样。这和Java的命名空间方式差别很大。 不过，根源就在于单例模式对单测的支持度较差，能解决单例模式的对象mock，就比较好搞定单测。  
   
> 20:37:02  bingye-滴滴-国际化-北京  
   
其中，YAF框架可以通过参数注入和构造注入解决mock，CI及Yii就需要修改底层框架源码，来达到对单例对象的Mock注入。  
   
> 20:37:02  bingye-滴滴-国际化-北京  
   
接下来，要面对的就是数据库和缓存，要不要mock的问题。 经过实践，我采取的是使用各自的mysql和redis，在启动测试用例的时候，写入固定的单测数据。这么做的考虑主要有： 1.数据库里的数据能用于单元测试，也可以用于QA的接口及集成测试； 2.mock数据库和缓存，更多的要看代码层面，这有的时候成本较大；  
   
> 20:37:02  bingye-滴滴-国际化-北京  
   
最后，从QA同学学到的，单元测试都用中文组织，可以明显提高单测可读性。。。。。。。  
   
> 20:37:02  bingye-滴滴-国际化-北京  
   
比较可惜的是，持续半年的PHP单测实践，还是没能成功坚持下来。 PHP的单测还是有一定的学习，上手成本。 特别是复杂业务，对case的维护需要更多的投入。 不过，我还是看好单元测试，因为会使用单测的人，在代码调试，代码质量方面都更有效率，效果更好。  
   
> 20:37:02  bingye-滴滴-国际化-北京  
   
最后总结下： PHP的单测，要考虑： 1.解决PHP的框架是第一要做的事情，对于部分框架，可能要修改框架源码； 2.PHP多是WEB开发，推荐做接口级别的单测； 3.做好单测前的数据库等数据准备，不使用数据库mock； 4.可以考虑用中文来组织编写单元测试； 5.优化单测环境搭建，执行，可以让更多人使用单测，这部分优化可能更易于团队走上单测的道路。 做的比较挫，大家不要见笑  
   
> 20:37:02  bingye-滴滴-国际化-北京  
   
再附上以前写的一个分享PPT，内容差不多。  
   
> 20:37:02  bingye-滴滴-国际化-北京  
   
解决完框架方面的问题，就要开始考虑，写怎么样的单测，是函数级别的单测，还是接口级别的单测。 在PHP方面，我倾向于做接口级别的单测，输入数据写在$_POST[]中，然后，执行controller。 在java方面，我就倾向于做函数级别的单测，成本较小。  
   
> 20:37:03  bingye-滴滴-国际化-北京  
   
![2018-10-28 20:37:03](http://static.cocolian.cn/img/20181028_203703.png) 
   
> 20:37:03  bingye-滴滴-国际化-北京  
   
[单元测试分享.pdf
]()  
   
> 20:38:16  陈才林-产品-时代科技-广州  
   
签到  
   
> 20:38:51  wxid_wtjag9bub6rs22  
   
签到  
   
> 20:38:56  dreamup-平安-产品  
   
签到  
   
> 20:43:20  海锋-合利宝-研发-广州  
   
签到  
   
> 20:43:25  风兮-Java技术-上海  
   
签到  
   
> 20:44:01  郑增远—WIND—攻城狮—上海  
   
签到  
   
> 20:54:46  陈健-HFB-CTO-北京  
   
签到  
   
> 20:55:23  曾卓-长丰集团-架构师-长沙  
   
签到  
   
> 21:02:13  csp-架构-深圳  
   
签到  
   
> 21:05:59  el-渣打-后台开发  
   
签到  
   
> 21:11:08  张杨-航天电子-研发-北京  
   
签到  
   
> 21:13:21  于有码-技术  
   
签到  
   
> 21:19:52  杨万新 技术 浙江触角  
   
签到  
   
> 21:24:30  李胜勇-永乐-G-北京  
   
签到  
   
> 21:36:24  张震南-信雅达-互联网支付-杭州  
   
签到  
   
> 21:39:47  蔡章正-mt-结算系统  
   
签到  
   
> 21:39:55  王成龙-新浪跨境-研发-上海  
   
签到  
   
> 22:04:33  冯建熙—差旅天下—产品经理  
   
感谢老板  
   
> 22:04:55  杨宽-比特大陆-区块链理疗师-bj  
   
[1024程序员节｜我们想和你一起改变世界
](http://mp.weixin.qq.com/s?__biz=MzIxMjU4NzU5NA==&amp;amp;amp;mid=2247484209&amp;amp;amp;idx=1&amp;amp;amp;sn=63ea373166ff93bd55c4fe7ff3c4277d&amp;amp;amp;chksm=97428614a0350f02b256f42becd2bb61608283526ae1d65f3ed28599652b6cb68d6a20fb6573&amp;amp;amp;mpshare=1&amp;amp;amp;scene=1&amp;amp;amp;srcid=1024nY82ZljykK8fYujYd0eH#rd)  
   
> 22:05:05  杨宽-比特大陆-区块链理疗师-bj  
   
给留言区，我的狗头留言点赞。  
   
> 22:05:28  杨宽-比特大陆-区块链理疗师-bj  
   
红包大于五毛的，点下赞，其他人suiyi[呲牙]  
   
> 22:06:16  wxid_ibbzw7f75v531  
   
拿人钱财与人方便[机智]  
   
> 22:06:40  杨宽-比特大陆-区块链理疗师-bj  
   
打扰大家了  
   
> 22:16:37  Eric-Silot-SG  
   
签到  
   
> 22:16:43  Eric-Silot-SG  
   
刚落地  
   
