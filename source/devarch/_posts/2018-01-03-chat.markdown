---
layout:     source 
title:      "2018-01-03-WeChat"
date:       2018-01-03 12:00:00
author:     Codefor-YMT-TechLead-BJ
lines:      97 
tag:		  [chat]
---
> 06:56:08  李雄峰  
   
20171228-一次支付系统升级过程经验教训分享  
   
> 06:56:24  Yezhiwei-融汇金信-技术-北京  
   
[强]  
   
> 06:56:29  Yezhiwei-融汇金信-技术-北京  
   
早  
   
> 06:56:56  leon  
   
[强]  
   
> 07:33:45  夏志强~快付通~技术经理  
   
我们11月也做了一次这种升级，还好比较顺利  
   
> 08:03:49  小七～研发  
   
[强]  
   
> 08:11:30  Codefor-YMT-TechLead-BJ  
   
??群主好早啊  
   
> 08:31:43  韩财光-东软(前)-开发-广州  
   
@Codefor-YMT-TechLead-BJ?你们有多少个服务 在内网布置一套一模一样的环境 包括数据库结构软件版本网络参数等等 不会很麻烦吧  
   
> 09:02:21  时光来过  
   
我记得58神剑公众号说过在线加字段的办法  
   
> 09:23:10  Codefor-YMT-TechLead-BJ  
   
我们Q3统计至少有100个微服务  
   
> 09:23:40  Codefor-YMT-TechLead-BJ  
   
Q4还没汇总，预计会突破200个。外网接入API超过500个。内网ESB网关接口更多  
   
> 09:24:10  Codefor-YMT-TechLead-BJ  
   
主要是各种语言都有，Go，Python，Java，C。  
   
> 09:24:56  Codefor-YMT-TechLead-BJ  
   
目前SYS只有基于Jenkins的发布系统，docker只是用Swarm试点，正在调研K8s  
   
> 09:26:34  Codefor-YMT-TechLead-BJ  
   
业务迭代非常快，算上插件，APP基本上每周都要发版本。后台的升级就更频繁了。 SYS人手也有限，基础架构这块进度落后  
   
> 09:27:25  Codefor-YMT-TechLead-BJ  
   
2017年把配置标准化了，接下去会强力推docker和服务治理  
   
> 09:29:03  Codefor-YMT-TechLead-BJ  
   
这么多组件，环境治理，专职运维就一个人[流泪]其余都是打帮手 没办法，小公司要活命，资源有限  
   
> 09:29:38  李胜军  
   
你们团队多少人啊，搞这么多服务  
   
> 09:30:05  韩财光-东软(前)-开发-广州  
   
内网维护一套完全一样的环境 甚至包括域名系统 用于测试收集环境参数等都是有益的 也可能你们的环境太复杂了 k8s测过 文档看着美好但坑多 目前快速更新很不稳定 慎入  
   
> 09:31:18  Codefor-YMT-TechLead-BJ  
   
技术部算QA，OP一共40人吧。 农业领域都是摸着石头过河，业务不确定很大，技术就要快速跟进，不然公司就会死掉。技术团队倒是非常稳定。  
   
> 09:32:37  Codefor-YMT-TechLead-BJ  
   
最近k8s很火啊，我看前一段你和老熊也都在弄k8s 我们目前线上Swarm跑了二十几个服务，但是有些慢查询，负载均衡和网络都有点问题。所以正在调研k8s  
   
> 09:34:14  韩财光-东软(前)-开发-广州  
   
k8s环节太多 某一节点弱就会拖累整体 况且他多个部件都同时弱 docker不适应严肃场景 网络方案五花八门都不稳定   
   
> 09:35:32  Codefor-YMT-TechLead-BJ  
   
我们SYS的第一目标是可用性。所有业务不能有单点。然后是可扩展性，流量翻10倍的时候，系统可以快速线性扩容。  我觉得我们最大的问题是，技术选型过于异构。各个服务异构对于运维挑战很大。 这也是历史有关系，人少，就不能太限制大家发挥，只要满足服务SLA，具体的实现leader负责即可  
   
> 09:35:33  韩财光-东软(前)-开发-广州  
   
等他稳定了可以用 会降低运维压力 当做自动化部署工具一样   
   
> 09:36:22  Codefor-YMT-TechLead-BJ  
   
k8s还有这么多坑啊。我估计我们定的Q2的目标完不成了[流泪]  
   
> 09:37:21  我  
   
大家好， 1月13日报名名额已满。 报名成功的同学都加入了聚会群了。 如果有同学报名后没有入群的，请联系我，谢谢。   
   
> 09:39:50  王伟  
   
@凤凰牌老熊?做什么专题演讲  
   
> 09:43:32  我  
   
有嘉宾做主题分享。   
   
> 09:44:07  我  
   
争取能够持续办下去。  
   
> 09:44:13  泽西-趋恒-架构师  
   
好耶  
   
> 09:44:41  玲汀  
   
??  
   
> 09:44:43  Yezhiwei-融汇金信-技术-北京  
   
[强][强]  
   
> 09:46:04  Codefor-YMT-TechLead-BJ  
   
到时候，求直播啊@凤凰牌老熊  
   
> 09:47:40  我  
   
这个比较困难。   
   
> 09:47:52  我  
   
只能过滤敏感信息后放到网上。   
   
> 09:48:22  张百音  
   
[强]  
   
> 09:48:32  x69342  
   
[强]  
   
> 10:09:04  奶瓶  
   
有在银行的朋友吗，里面的氛围咋样？能给说下不  
   
> 10:09:59  陈鹏  
   
务实  
   
> 10:10:20  陈帅康  
   
站队比较严重  
   
> 10:10:50  陈鹏  
   
科技条线不会  
   
> 10:11:12  韩涛  
   
讲真，稍微大一点公司，都有站队现象的  
   
> 10:11:52  奶瓶  
   
银行这样的 官僚作风是不是多一点[坏笑]  
   
> 10:12:12  陈鹏  
   
你们都有误解  
   
> 10:12:53  陈鹏  
   
不要拿90年代的国企作风来看待今天的银行[偷笑]  
   
> 10:13:34  x69342  
   
3个人的地方，就存在站队  
   
> 10:13:36  夏志强~快付通~技术经理  
   
大小企业都有  
   
> 10:13:58  夏志强~快付通~技术经理  
   
有的几个人，都有战队问题  
   
> 10:16:11  胡桥-资邦金服-账务核心业务架构  
   
干好自己的活，领工资就行，和直属领导保持一致就行[捂脸]  
   
> 10:16:52  胡桥-资邦金服-账务核心业务架构  
   
还有就是打工永远发不了财[捂脸][捂脸][捂脸]  
   
> 10:17:08  奶瓶  
   
直属领导都被干掉了……  
   
> 10:18:06  地平线-文思-产品  
   
@奶瓶-国商-研发?每家银行都不一样  
   
> 10:18:18  北京一张泽雄  
   
个人能力才是关键，只要能力好，领导都会拉你的  
   
> 10:19:10  北京一张泽雄  
   
每个领导都希望有个得力的助手来把自己抬上去  
   
> 10:19:11  程琳Wa-杉德支付-产品-上海  
   
张总这话说出了领导的心声[偷笑][偷笑][强][强]  
   
> 10:19:30  杜蒙-途家-产品-北京  
   
高屋建瓴啊  
   
> 10:19:51  北京一张泽雄  
   
哈哈，这就是只有利益才是永恒的  
   
> 10:20:33  胡桥-资邦金服-账务核心业务架构  
   
直属领导被干掉了，那就的走人啦  
   
> 10:21:30  奶瓶  
   
这不就在寻觅呢嘛  
   
> 10:22:56  北京一张泽雄  
   
还是那句话，有能力都不怕，你的上上级会赏识你，即使国为上级领导的原因自己被开了，一转身又是一个好工作  
   
> 10:23:00  胡桥-资邦金服-账务核心业务架构  
   
可能年纪大了，觉得在上海，人才太多了，无非就是标价不一样，觉得和志同道合，比能力重要??  
   
> 10:23:40  北京一张泽雄  
   
能力才是你饿不死的资本  
   
> 10:23:44  李秀刚  
   
张总用五笔输入法？  
   
> 10:23:48  北京一张泽雄  
   
对  
   
> 10:24:02  李秀刚  
   
同龄人  
   
> 10:24:03  李秀刚  
   
哈哈  
   
> 10:24:22  北京一张泽雄  
   
哈哈  
   
> 10:26:16  北京一张泽雄  
   
如果没有能力，领导都找不到工作，自己还不饿死？  
   
> 10:27:29  hgwym  
   
[强]自身过硬才是关键  
   
> 10:29:50  奶瓶  
   
一颗红心 两首准备，先拿几个offer再说啊  
   
> 10:30:01  胡桥-资邦金服-账务核心业务架构  
   
大家不是造火箭原子弹，都是做经济型的业务工作，现在是知识增量型的社会，接触知识的机会比个人能力重要。  
   
> 10:30:46  胡桥-资邦金服-账务核心业务架构  
   
@奶瓶-国商-研发 来我们公司呗，有推荐费，咱们对半分[耶]  
   
> 10:30:57  x69342  
   
打工永远发不了财[偷笑][强] 吃饭靠努力，发财看运气  
   
> 10:33:18  奶瓶  
   
你们大上海消费不起，怕挣的钱不够吃穿啊@胡桥-资邦-账务?  
   
> 16:41:30  钟鸿敏  
   
你们现在用什么全家桶的工具呢（项目管理，代码管理，codereview，wiki）  
   
> 16:48:34  钟鸿敏  
   
有谁有更好的推荐吗？phab还不错，不过项目管理好弱  
   
> 16:48:35  钟鸿敏  
   
![2018-01-03 16:48:35](http://static.cocolian.cn/img/201801/20180103_164835.png) 
   
> 16:49:31  bill在飞  
   
wiki有推荐吗？  非破解版的  
   
> 16:50:54  钟鸿敏  
   
pb就可以  
   
> 16:53:54  Ryan Cao  
   
atlassian  
   
> 16:55:22  顽石  
   
JIRA  
   
> 16:55:59  钟鸿敏  
   
我是要全家桶，就一个工具可以完成上面四项的，不想搭太多  
   
> 16:56:20  钟鸿敏  
   
ph能满足，就是项目管理风格不习惯，没有jira好  
   
> 16:57:57  Codefor-YMT-TechLead-BJ  
   
WIKI,JIRA,买了license  
   
> 16:58:08  Codefor-YMT-TechLead-BJ  
   
都是atlassian一家的  
   
> 17:00:56  顽石  
   
Atlassian基本就满足你的需求了  
   
> 17:07:20  钟鸿敏  
   
一家的，但是产品是分开的  
   
> 17:41:30  钢星  
   
我们是confluence+JIRA+git  
   
> 17:48:56  钟鸿敏  
   
我们也是，想找一个all in one的  
   
> 20:02:25  钢星  
   
请教一个，对账遇到的问题，账户对账单和交易流水的核对，当数据量较大时（假设每天1000W条），想要考虑要分片，以什么维度分片合适？ 1、如果以交易时间分片，那么得每次分片查询都要按照交易时间排序，会降低查询的效率。 2、如果以其他维度分片，那么如何能够最大概率命中对账的交易流水。  
   
> 20:02:26  syu  
   
支付宝或微信的付款码是按照什么规则生成的，哪位知道呢？  
   
> 20:02:27  钢星  
   
![2018-01-03 20:02:27](http://static.cocolian.cn/img/201801/20180103_200227.png) 
   
> 20:04:49  Codefor-YMT-TechLead-BJ  
   
上Hadoop啊，按对账要素为key排一下就行了  
   
> 20:26:28  夏志强~快付通~技术经理  
   
可以渠道纬度  
   
> 20:43:19  韩财光-东软(前)-开发-广州  
   
@张磊-信美-研发?前面有讨论过  
   
> 20:49:33  钢星  
   
@Codefor-YMT-TechLead-BJ  初期上hadoop成本比较高，最近有迭代版本也可能来不及，想看看java有没有合适的办法  
   
> 20:49:54  钢星  
   
@夏志强~快付通~技术经理  嗯嗯，渠道维度可以加进来看看  
   
> 20:50:15  钢星  
   
@韩财光-东软(前)-开发-广州  我翻翻  
   
> 20:54:41  杨浩  
   
你们对账的数据要保留多久？  
   
> 21:02:26  钢星  
   
现在还没做数据的备份和清理，现在有页面查询历史对账的结果，感觉上需要保留近1年或半年的  
   
> 21:42:07  Codefor-YMT-TechLead-BJ  
   
按渠道切分后，单机内存够的话，直接单进程跑就行。我们对账用Python写，很快  
   
