---
layout:     source 
title:      "2017-08-09-WeChat"
date:       2017-08-09 12:00:00
author:     "PaymentGroup"
tag:		  [chat]
header-img: "img/post-bg-wechat.jpg"
---
> 07:53:06  Allen-一号车交易和支付PM  
   
关于风控系统，请假各位大神，数据存储层，一般技术选型是什么?  
   
> 07:53:13  Allen-一号车交易和支付PM  
   
请教  
   
> 08:01:54  Allen-一号车交易和支付PM  
   
比如我现在遇到一个问题：我们现在选择hbase,es和mysql。但是hbase的存储能力很强，但是获取速度相对一般，那这样的话，基于hbase，是不是还有别的技术来解决这个问题  
   
> 08:14:50  忘乎所以-腾讯-支付线风控后台开发  
   
机器够的话用两套[呲牙][呲牙][呲牙]，es做实时分析，hbase做离线分析  
   
> 08:38:11  张泽雄-民生金服 项目总监  
   
我一会给你个图  
   
> 08:40:12  张泽雄-民生金服 项目总监  
   
数据存储参考lambd架构  
   
> 09:08:42  Allen-一号车交易和支付PM  
   
太感谢了  
   
> 09:11:51  我  
   
20170802-收银台优惠  
   
> 09:12:33  Peter-找钢网-PM  
   
[强]  
   
> 09:13:27  小七-拉卡拉-工程师  
   
[强]  
   
> 09:13:41  WLX-支付通项目主管  
   
[强][强]  
   
> 09:13:57  萍萍妞  
   
[强]  
   
> 09:14:15  我  
   
@群-招行-研发-上海  感谢，也帮忙看看是否有不合适发布的内容。   
   
> 09:18:46  张洋-平安信托-产品-深圳  
   
??  
   
> 09:30:19  张泽雄-民生金服 项目总监  
   
@Allen -开元金融-技术经理-北京    
   
> 09:30:28  张泽雄-民生金服 项目总监  
   
![2017-08-09 09:30:28](http://static.cocolian.cn/img/20170809_093028.png) 
   
> 09:37:31  叶林松-微众银行高级产品经理  
   
[强]  
   
> 09:57:39  钟文帅-移付宝科技-产品经理  
   
请教大家个问题，在平台的日切和上游渠道的日切时间差距有半小时，导致了这半小时产生了大量的长短款，平台方应如何去避免或减少这种问题？  
   
> 10:22:42  Allen-一号车交易和支付PM  
   
@张泽雄-民生金服-研发-北京   非常感谢  
   
> 10:25:50  张泽雄-民生金服 项目总监  
   
客气了  
   
> 10:48:32  Jack-捷信消费金融技术主管  
   
大家有没有做过根据收款方银行来做outage的  
   
> 10:58:18  姚刚-阿里-PD  
   
想问下大家，对外收单产品有没有做体验版的？能否简单介绍下？  
   
> 11:01:44  庄浩田-51信用卡支付清算产品  
   
@钟-天下支付PM-深圳 你约定对账时，统一以渠道日切时间点来获取数据，你自己的日切点和对账本身其实没有太大关联  
   
> 11:08:52  哦哦哦-招商银行卡中心  
   
@老熊-北京?没有哈[呲牙]  
   
> 11:12:05  张泽雄-民生金服 项目总监  
   
@钟-天下支付PM-深圳  这个问题我记得以前讨论过，这个没法避免，指导原则就是不要产生短款，一般都是平台提前几分钟日终，产生差错并不是问题，关键是要能识别并标记出差错的原因，给出差错码，后期系统按差错码自动处理。  
   
> 11:14:26  张泽雄-民生金服 项目总监  
   
将记录处理过程记清楚就可以了  
   
> 11:14:29  张泽雄-民生金服 项目总监  
   
![2017-08-09 11:14:29](http://static.cocolian.cn/img/20170809_111429.png) 
   
> 11:14:31  钟文帅-移付宝科技-产品经理  
   
差错码是个好办法  
   
> 11:21:11  钟文帅-移付宝科技-产品经理  
   
@张泽雄-民生金服-研发-北京 那我理解成，给日终附近的交易都加上标记，当对账时出现差错帐，让系统先处理掉那些带有标记的帐，对吗？  
   
> 11:25:38  张泽雄-民生金服 项目总监  
   
1. 不要特殊处理，所以不是日终附近的，而是所有记录统一处理。 2. 只有产生差错，才会去记录表里去查，结合规则得到不同的差错码。  
   
> 11:26:49  张泽雄-民生金服 项目总监  
   
因为差错不仅仅是由于日终产生的，虽然概率不是很大。  
   
> 13:54:37  张泽雄-民生金服 项目总监  
   
有哪位朋友了解回望期权的？给解释一下，谢谢！  
   
> 13:56:23  王伟-携程-产品  
   
@钟-天下支付PM-深圳 如果能够做自动对账，那这个就没有问题了  
   
> 15:25:37  Allen-一号车交易和支付PM  
   
@张泽雄-民生金服-研发-北京      回望期权：http://futures.jrj.com.cn/2015/06/08071219324295.shtml  
   
> 15:26:04  张泽雄-民生金服 项目总监  
   
OK，3Q  
   
> 15:27:50  华-南京亚软-IT总监  
   
做一个滚动对账  
   
> 15:28:24  华-南京亚软-IT总监  
   
比如第一次对账发生长短款后，标记一下；  
   
> 15:29:40  华-南京亚软-IT总监  
   
第二次再对账会对之前的数据做一次纠正，超时后还是长短款，就要升级状态（比如状态显示：异常），这时候做自动补偿，或是由运营、维人员管理；  
   
> 16:01:43  夏飞-广东网金  
   
![2017-08-09 16:01:43](http://static.cocolian.cn/img/20170809_160143.png) 
   
> 16:02:08  夏飞-广东网金  
   
这种卡是什么卡  
   
> 16:03:50  张泽雄-民生金服 项目总监  
   
如果有人用ZipKin+elasticsearch的时候 ，注意一下，默认的版本1.23.2中这个parsIP()不存在，需要升级版本，在POM中强制覆盖默认版本  
   
> 16:03:51  张泽雄-民生金服 项目总监  
   
![2017-08-09 16:03:51](http://static.cocolian.cn/img/20170809_160351.png) 
   
> 16:03:52  张泽雄-民生金服 项目总监  
   
![2017-08-09 16:03:52](http://static.cocolian.cn/img/20170809_160352.png) 
   
> 17:03:24  我  
   
[强]  
   
> 18:55:40  程琳-杉德支付-PM  
   
今天请到一位朋友，@雪鹰-海尔.快捷通-架构 给大家做分享。主题是“支付引擎设计”，开始时间为【19:30】迎欢迎[鼓掌][鼓掌][鼓掌]！（注： 1.嘉宾分享期间其他人不要发言打断嘉宾分享。2.分享完成后请大家积极补充和提问；3.烦请领取红包签到，谢谢！）  
   
> 18:55:56  程琳-杉德支付-PM  
   
微信红包  
   
> 18:56:55  程琳-杉德支付-PM  
   
欢迎海尔.快捷通架构童鞋的分享[鼓掌][鼓掌][鼓掌]  
   
> 18:57:23  钟文帅-移付宝科技-产品经理  
   
[强]  
   
> 18:57:27  劉皇叔  
   
[鼓掌][鼓掌][鼓掌][鼓掌]  
   
> 18:57:28  张泽雄-民生金服 项目总监  
   
[鼓掌][鼓掌]  
   
> 18:57:38  WillYang-嘉联支付-架构师  
   
[鼓掌][鼓掌]  
   
> 18:57:41  程恩惠  
   
[强]  
   
> 18:57:54  王涵  
   
[鼓掌][鼓掌]  
   
> 18:57:58  yuesheng.yin  
   
[强]  
   
> 18:58:31  周红仁-去哪儿支付  
   
[强]  
   
> 18:58:32  Wall-E 爱贝云计费产品主管  
   
[强][强]  
   
> 18:58:55  李兴-有赞技术专家  
   
[强]  
   
> 18:58:57  文奇  
   
[强]  
   
> 18:59:05  ??Ray??  
   
[强]  
   
> 18:59:25  邱显-融数金服-支付风控  
   
[强][强]  
   
> 18:59:27  uniker  
   
[强]  
   
> 18:59:39  Pat-海尔互金架构师  
   
[强]  
   
> 18:59:44  程林－科蓝－北京  
   
[强][强]  
   
> 19:00:18  李子枞-齐商银行 电子银行部   
   
[强]  
   
> 19:00:22  Leo  
   
[鼓掌]  
   
> 19:01:10  落雪飞花-农信互联-开发经理  
   
[强]  
   
> 19:02:22  徐萍 途牛产品总监  
   
[强]  
   
> 19:02:37  大智若愚-翼支付-产品总监  
   
[强]  
   
> 19:02:43  仙贝-中汇支付 技术主管  
   
[强]  
   
> 19:03:03  昕小姐-1号店产品  
   
[强]  
   
> 19:03:11  华-南京亚软-IT总监  
   
[强]  
   
> 19:03:18  atom-汇付-产品-上海  
   
[强]  
   
> 19:03:49  大宇-快马医疗-CTO  
   
[强]  
   
> 19:04:27  牙印儿-新浪支付产品经理  
   
[强]  
   
> 19:04:40  上海块钱业务分析师  
   
[强]  
   
> 19:05:04  胡永  
   
[强][强]  
   
> 19:05:54  李小-交通银行商户运营 支付PM  
   
[强]  
   
> 19:08:17  甘建新-快捷通支付架构师  
   
[强]  
   
> 19:08:56  王燕强-房天下-支付网关PL  
   
[强]  
   
> 19:09:51  吴浩-小牛在线  
   
[强]  
   
> 19:10:04  MX农行  
   
[强][强]  
   
> 19:10:20  韩财光  
   
[强][强]  
   
> 19:12:37  Chess-技术总监 首付游   
   
[强]  
   
> 19:15:42  华-南京亚软-IT总监  
   
![2017-08-09 19:15:42](http://static.cocolian.cn/img/20170809_191542.png) 
   
> 19:16:20  华-南京亚软-IT总监  
   
![2017-08-09 19:16:20](http://static.cocolian.cn/img/20170809_191620.png) 
   
> 19:16:40  华-南京亚软-IT总监  
   
500个税号，是不是指企业有500个下下属单位  
   
> 19:17:57  华-南京亚软-IT总监  
   
还是说最多可以接入500家企业；  
   
> 19:37:49  Tim-魔线科技-产品总监  
   
一个企业不是只有一个税号吗？  
   
> 19:41:16  袁军-架构师-快捷通  
   
大家好，不好意思，刚有点事情在处理，今天晚上由我进行分享，分享内容关于支付引擎设计。  
   
> 19:42:52  袁军-架构师-快捷通  
   
首先介绍下快捷通支付系统的核心架构：  
   
> 19:43:18  袁军-架构师-快捷通  
   
![2017-08-09 19:43:18](http://static.cocolian.cn/img/20170809_194318.png) 
   
> 19:44:52  袁军-架构师-快捷通  
   
今天主要分享的就是中间一个核心系统-支付引擎  
   
> 19:46:13  袁军-架构师-快捷通  
   
典型转账账务处理流程：  
   
> 19:46:14  袁军-架构师-快捷通  
   
![2017-08-09 19:46:14](http://static.cocolian.cn/img/20170809_194614.png) 
   
> 19:46:50  袁军-架构师-快捷通  
   
支付引擎主要功能就是如何驱动如上账务的流转  
   
> 19:47:52  袁军-架构师-快捷通  
   
![2017-08-09 19:47:52](http://static.cocolian.cn/img/20170809_194752.png) 
   
> 19:48:34  袁军-架构师-快捷通  
   
![2017-08-09 19:48:34](http://static.cocolian.cn/img/20170809_194834.png) 
   
> 19:49:08  袁军-架构师-快捷通  
   
![2017-08-09 19:49:08](http://static.cocolian.cn/img/20170809_194908.png) 
   
> 19:49:44  袁军-架构师-快捷通  
   
![2017-08-09 19:49:44](http://static.cocolian.cn/img/20170809_194944.png) 
   
> 19:50:19  袁军-架构师-快捷通  
   
![2017-08-09 19:50:19](http://static.cocolian.cn/img/20170809_195019.png) 
   
> 19:50:52  袁军-架构师-快捷通  
   
![2017-08-09 19:50:52](http://static.cocolian.cn/img/20170809_195052.png) 
   
> 19:51:54  袁军-架构师-快捷通  
   
![2017-08-09 19:51:54](http://static.cocolian.cn/img/20170809_195154.png) 
   
> 19:52:28  袁军-架构师-快捷通  
   
![2017-08-09 19:52:28](http://static.cocolian.cn/img/20170809_195228.png) 
   
> 19:53:16  袁军-架构师-快捷通  
   
![2017-08-09 19:53:16](http://static.cocolian.cn/img/20170809_195316.png) 
   
> 19:53:49  袁军-架构师-快捷通  
   
![2017-08-09 19:53:49](http://static.cocolian.cn/img/20170809_195349.png) 
   
> 19:54:10  袁军-架构师-快捷通  
   
![2017-08-09 19:54:10](http://static.cocolian.cn/img/20170809_195410.png) 
   
> 19:54:40  袁军-架构师-快捷通  
   
![2017-08-09 19:54:40](http://static.cocolian.cn/img/20170809_195440.png) 
   
> 19:54:54  袁军-架构师-快捷通  
   
![2017-08-09 19:54:54](http://static.cocolian.cn/img/20170809_195454.png) 
   
> 19:55:23  袁军-架构师-快捷通  
   
![2017-08-09 19:55:23](http://static.cocolian.cn/img/20170809_195523.png) 
   
> 19:55:42  袁军-架构师-快捷通  
   
![2017-08-09 19:55:42](http://static.cocolian.cn/img/20170809_195542.png) 
   
> 19:56:01  袁军-架构师-快捷通  
   
![2017-08-09 19:56:01](http://static.cocolian.cn/img/20170809_195601.png) 
   
> 19:56:33  袁军-架构师-快捷通  
   
![2017-08-09 19:56:33](http://static.cocolian.cn/img/20170809_195633.png) 
   
> 19:57:25  袁军-架构师-快捷通  
   
![2017-08-09 19:57:25](http://static.cocolian.cn/img/20170809_195725.png) 
   
> 19:57:50  袁军-架构师-快捷通  
   
![2017-08-09 19:57:50](http://static.cocolian.cn/img/20170809_195750.png) 
   
> 20:00:22  袁军-架构师-快捷通  
   
最后一个图支付系统核心数据：  
   
> 20:00:23  袁军-架构师-快捷通  
   
![2017-08-09 20:00:23](http://static.cocolian.cn/img/20170809_200023.png) 
   
> 20:00:40  袁军-架构师-快捷通  
   
好了，我太懒了~~  分享完了~~  
   
> 20:02:57  我  
   
[强]， 都是精髓。   
   
> 20:03:13  华-南京亚软-IT总监  
   
太赞了  
   
> 20:03:22  WillYang-嘉联支付-架构师  
   
[强][强]  
   
> 20:03:26  周红仁-去哪儿支付  
   
谢谢分享  
   
> 20:03:27  ibmHuang  
   
太精髓  
   
> 20:03:51  蘑菇街_陈宗  
   
[强] 我得好好消化，后续和@雪鹰-海尔·快捷通-架构 请教  
   
> 20:04:01  豆角茄子-卡友支付-PM  
   
[强][强][强]  
   
> 20:05:08  崔奕  
   
@雪鹰-海尔·快捷通-架构?请问规则引擎是用什么实现的  
   
> 20:06:00  韩财光  
   
感兴趣用什么画图工具  
   
> 20:06:10  袁军-架构师-快捷通  
   
@铁手_蘑菇街_技术_杭州  互相学习[握手]  
   
> 20:07:26  袁军-架构师-快捷通  
   
@CSII-崔奕  引擎写代码实现的~  
   
> 20:09:25  袁军-架构师-快捷通  
   
@韩财光-东软(前)-开发-广州  大部分都PPT，有几个powerdesigner画的  
   
> 20:10:21  韩财光  
   
好强   
   
> 20:11:42  pangning-安邦集团收付团队研发  
   
挺好的  
   
> 20:12:06  龚晓冬-银商账户-产品-上海  
   
@雪鹰-海尔·快捷通-架构?好多图的架构和支付宝很像～  
   
> 20:12:15  袁军-架构师-快捷通  
   
说下优缺点吧：1.账务流程清晰，全流程复试账务展现，基本可以省掉账帐核对。2.支持灵活配置账务流程  缺点：流程比较长支付响应时间会长点  
   
> 20:14:57  袁军-架构师-快捷通  
   
可能和一些支付公司的都会有些像的~[憨笑]  
   
> 20:15:26  袁军-架构师-快捷通  
   
只是整理分享下。  
   
> 20:16:14  stranger-同城旅游支付PL  
   
@雪鹰-海尔·快捷通-架构  我请教下，就是看你们支付引擎的链路很长，其中有个节点我不是太清楚，就是支付前置是起什么作用的？  
   
> 20:18:34  袁军-架构师-快捷通  
   
![2017-08-09 20:18:34](http://static.cocolian.cn/img/20170809_201834.png) 
   
> 20:18:43  袁军-架构师-快捷通  
   
看这个图就明白了  
   
> 20:21:11  Alive-借贷宝-PL  
   
[强]， 都是精髓。  
   
> 20:21:23  stranger-同城旅游支付PL  
   
这张图信息量好大， 我得好好看看  
   
> 20:21:31  Alive-借贷宝-PL  
   
@雪鹰-海尔·快捷通-架构    都是干货！  
   
> 20:22:22  少帅-快捷通支付产品  
   
@雪鹰-海尔·快捷通-架构?，文字说明下[呲牙]  
   
> 20:23:11  Alive-借贷宝-PL  
   
问个问题：  
   
> 20:23:12  Alive-借贷宝-PL  
   
![2017-08-09 20:23:12](http://static.cocolian.cn/img/20170809_202312.png) 
   
> 20:23:19  袁军-架构师-快捷通  
   
比如，卡到卡转账，可以是快捷支付（入款指令）+出款（出款指令） 2个组合起来构成完成流程。   
   
> 20:23:21  Alive-借贷宝-PL  
   
收银台和网关是怎么划分的  
   
> 20:23:34  Alive-借贷宝-PL  
   
边界是什么  
   
> 20:24:09  袁军-架构师-快捷通  
   
收银台是有选择页面的，网关是API，嗯的修改下下。  
   
> 20:24:38  袁军-架构师-快捷通  
   
从网关API过来交易可能会跳转收银台界面。  
   
> 20:25:35  袁军-架构师-快捷通  
   
服务是分开的。 SOA 架构核心：分层与服务化  
   
> 20:28:23  Alive-借贷宝-PL  
   
支付核心业务配置关系 1，2…是什么意思呢  
   
> 20:32:07  袁军-架构师-快捷通  
   
没有特别意思，数据使用或产生的顺序~~  
   
> 20:35:43  Alive-借贷宝-PL  
   
我得好好消化，后续再请教！  
   
> 20:43:14  李伟锋  
   
1.账务流程清晰，全流程复试账务展现，基本可以省掉账帐核对  @雪鹰 这句怎么理解的？  
   
> 20:47:10  李伟锋  
   
总分核对应该是账账核对的一个维度吧  
   
> 20:47:22  李伟锋  
   
没想明白[呲牙]  
   
> 20:49:05  邹奇峰Tsiffeng-海航合规部  
   
[强][强][强]  
   
> 20:49:44  袁军-架构师-快捷通  
   
可能账帐核对我理解不对，指的是相对记单边账务来说的。 交易系统和账务系统的核对。  
   
> 20:53:07  乔俊翔-爱又米-支付开发  
   
太精彩了，非常感谢  
   
> 20:53:47  李伟锋  
   
干货很多，好好消化下 [强]  
   
> 20:55:11  扫地僧  
   
[强][强][强]  
   
> 20:55:29  龚晓冬-银商账户-产品-上海  
   
@李伟锋-蘑菇街金融-杭州?交易系统和账务也要核对的～  
   
> 20:56:13  李伟锋  
   
恩 那应该属于账证核对范畴，不过这些概念性的东西 理解上也无所谓了  
   
> 20:57:21  李伟锋  
   
问个问题，比如说提现 要收手续费，手续费这块 在收单层面是怎么做的？  
   
> 20:59:08  袁军-架构师-快捷通  
   
手续费计算，还是扣除？  
   
> 20:59:50  李伟锋  
   
扣除  
   
> 21:00:41  李伟锋  
   
收单上会落扣费的明细吗  
   
> 21:04:21  袁军-架构师-快捷通  
   
看上面图 每个支付订单会对应支付参与方，每个参与方都有手续费   
   
> 21:04:28  袁军-架构师-快捷通  
   
![2017-08-09 21:04:28](http://static.cocolian.cn/img/20170809_210428.png) 
   
> 21:05:30  袁军-架构师-快捷通  
   
服务流程节点上会配置好规则，手续费不为0的就会产生相应账务明细。  
   
> 21:06:28  袁军-架构师-快捷通  
   
一般在账单中体现手续费，账单通过交易成功后消息异步生成。  
   
> 21:07:33  袁军-架构师-快捷通  
   
错了，异步更新手续费  
   
> 21:08:31  李伟锋  
   
恩恩 [抱拳]  
   
> 21:09:16  袁军-架构师-快捷通  
   
可以配置同时付款方、收款方都收手续费。  
   
> 21:09:28  少帅-快捷通支付产品  
   
牛逼  
   
> 21:10:18  袁军-架构师-快捷通  
   
账单付款方、收款方分开，分别记录手续费。  
   
> 21:10:37  袁军-架构师-快捷通  
   
复杂的还有分账方  
   
> 21:17:38  荣飞-有赞Java资深工程师  
   
艾媒咨询：2017上半年中国第三方移动支付市场研究报告  
   
> 21:29:41  蔡云龙 开联通支付  
   
谢谢分享  
   
> 21:30:00  袁军-架构师-快捷通  
   
还有个很大好处，账务不会出现重复，控制节点不会重复执行。  
   
> 21:32:22  albert郭  
   
谢谢分享  
   
> 22:32:17  胡圣 支付产品经理 猪八戒网  
   
谢谢分享  
   
> 22:41:44  田浩沛-银生宝电子支付公司技术总  
   
学习了了  
   
> 22:42:34  盒子先生-架构师，ABW  
   
都是精华，谢谢分享!  
   
> 22:56:45  于江宁-银联电子PM  
   
谢谢分享！  
   
> 23:34:19  于江宁-银联电子PM  
   
请教一下各位，优惠券和积分部分退款如何处理，比如一笔订单100元，其中优惠券抵扣10元，实际支付90元，退款95元，此时优惠券怎么处理？  
   
> 23:45:06  车睿??  
   
我们业务上，优惠券核销之后是不退的  
   
> 23:45:11  车睿??  
   
只退实付部分  
   
> 23:47:07  胡圣 支付产品经理 猪八戒网  
   
退款金额是不会让填95的，最多只能退90  
   
> 23:47:57  于江宁-银联电子PM  
   
那他退款85的话，优惠券也不会退了是吧  
   
> 23:48:23  于江宁-银联电子PM  
   
就是优惠券核销之后就不能再使用，直接作废？  
   
> 23:48:31  Schenchan-有赞  
   
@于江宁-ChinaPay-产品经理-上海?实退90。最大退款金额需要根据实际付款金额校对  
   
> 23:48:47  Schenchan-有赞  
   
一般都作废的   
   
> 23:49:08  车睿??  
   
是的，优惠券用掉之后，是不退的  
   
> 23:50:46  车睿??  
   
如果业务上有折扣卡之类的还有打折，退款填写的金额就需要包含折扣优惠的部分  
   
> 23:50:50  车睿??  
   
举个栗子  
   
> 23:51:09  于江宁-银联电子PM  
   
嗯 作废比较合理，这种优惠立减模式，是需要商户先打一笔钱（上例中10元）给支付机构，结算时支付机构就结算给商户10元吗？  
   
> 23:51:20  车睿??  
   
500元订单 8折卡 100券  支付： 优惠券100 折扣卡优惠 80 折扣卡实付120 微信支付200  金额退款：可退金额不得大于订单总额-优惠券金额 以此单为例，最大退款金额为400 设退款为300元 计算折扣卡优惠退款=300*0.2=60元 剩余240元优先退款三方支付微信=200元 剩余40元退款折扣卡  
   
> 23:54:45  于江宁-银联电子PM  
   
8折卡优惠是500元的八折还是500元减优惠券100元等于400元的8折  
   
> 23:55:42  车睿??  
   
400元  
   
> 23:55:47  车睿??  
   
优惠券后金额打折  
   
> 23:57:07  于江宁-银联电子PM  
   
500元订单 8折卡 100券  支付： 优惠券100 折扣卡优惠 80 折扣卡实付120 微信支付200  
   
> 23:57:21  车睿??  
   
你说的那种情况，要看有没有商家账户的概念吧，如果商家本身有账户概念，从账户中扣除即可。  
   
> 23:57:22  于江宁-银联电子PM  
   
为什么不是微信支付320元  
   
> 23:57:51  于江宁-银联电子PM  
   
而是折扣卡加微信320元  
   
> 23:57:54  车睿??  
   
我们是必须用卡才能享受卡折扣，这个例子是以卡余额不足以支付订单全款  
   
> 23:58:29  车睿??  
   
如果单独用微信，是木有折扣的  
   
> 23:58:50  车睿??  
   
而在使用卡的情况下，是需要优先消耗折扣卡余额  
   
> 23:58:51  于江宁-银联电子PM  
   
好吧。这个商户补贴的话，需要商户打钱给支付机构，这部分发票一般怎么开呢  
   
> 23:59:04  于江宁-银联电子PM  
   
又不是支付手续费  
   
> 23:59:07  于江宁-银联电子PM  
   
好的  
   
