---
layout:     source 
title:      "2018-01-06-WeChat"
date:       2018-01-06 12:00:00
author:     陆周雷-农行-开发人员-北京
lines:      112 
tag:		  [chat]
---
> 00:15:14  聚合支付_程昱  
   
q822090866:  
   
> 00:15:15  聚合支付_程昱  
   
q822090866:  
   
> 00:15:16  聚合支付_程昱  
   
q822090866:  
   
> 00:20:59  聚合支付_程昱  
   
[冷汗]信息量太大  
   
> 00:28:57  小穆-至尊商务-技术-郑州  
   
辛苦  
   
> 00:36:02  小穆-至尊商务-技术-郑州  
   
有没有12月份的呀  
   
> 08:33:54  青椒-众之金服-产品-成都  
   
[强]  
   
> 08:58:00  R  
   
2017年度GitHub上最热门的开源项目  
   
> 11:23:17  蔡少杏  
   
[强][强][强]  
   
> 17:01:05  程琳Wa-杉德支付-产品-上海  
   
今天请到一位朋友，@陆周雷-农行-开发人员-北京 给大家做分享，主题是“ 缴费中心的设计方案” 开始时间为【18:00】；欢迎欢迎[鼓掌][鼓掌][鼓掌]！（注： 1.嘉宾分享期间其他人不要发言打断嘉宾分享。2.分享完成后请大家积极补充和提问；3.烦请领取红包签到，谢谢！  
   
> 17:01:22  程琳Wa-杉德支付-产品-上海  
   
微信红包  
   
> 17:02:30  薛耀伟-58到家-开发-北京  
   
迁到  
   
> 17:02:35  陈宏  
   
签到  
   
> 17:02:41  程琳Wa-杉德支付-产品-上海  
   
欢迎放弃休息时间给大伙儿做分享的陆童鞋[鼓掌][鼓掌][鼓掌]  
   
> 17:02:43  勤奋-联通支付-产品-北京  
   
签到  
   
> 17:02:50  达文西-欣业邦-产品-重庆  
   
签到 +1  
   
> 17:03:02  陆训-51信用卡-开发  
   
签到  
   
> 17:03:17  王新-笑脸金融-架构-北京  
   
签到  
   
> 17:04:15  洪宇明_平安科技_开发经理_深圳  
   
签到  
   
> 17:06:59  黄灿-捷付睿通-开发-北京  
   
签到  
   
> 17:07:23  小马-海尔消金-开发-青岛  
   
签到  
   
> 17:10:11  鄢志明-聚和付-副总-深圳  
   
签到  
   
> 17:10:18  谢理-深圳-合规  
   
签到  
   
> 17:12:51  A-XiaoWei  
   
签到  
   
> 17:16:27  周雅雯-途虎养车-支付PM-上海  
   
签到  
   
> 17:17:06  小穆-至尊商务-技术-郑州  
   
签到  
   
> 17:17:09  李洪军-拉乌网络-研发经理-深圳  
   
签到  
   
> 17:17:44  liuhuibo  
   
签到  
   
> 17:18:49  梁媛  
   
签到  
   
> 17:26:06  Tom-澳门通-PMD  
   
签到  
   
> 17:29:37  田伟 David ????  
   
签到  
   
> 17:30:57  互金产品-郑式静-杭州  
   
签到  
   
> 17:35:06  何阳-天阳科技-开发-长春  
   
签到  
   
> 17:35:22  吕文伟_兴业银行总行  
   
签到  
   
> 17:36:55  mayni  
   
签到  
   
> 17:38:54  王向东  
   
签到  
   
> 17:39:49  何阳-天阳科技-开发-长春  
   
缴费涉及几个核心呀，算中间业务呗  
   
> 17:40:03  青椒-众之金服-产品-成都  
   
签到  
   
> 17:42:45  陈健-人人聚财-产品经理-深圳  
   
签到  
   
> 17:44:59  MyCity  
   
签到。  
   
> 17:50:22  医美消金-pm-上海  
   
签到  
   
> 17:51:16  王振兴-银盛-技术-青岛  
   
签到  
   
> 17:52:26  Ferry  
   
签到  
   
> 17:52:56  刘俭民-中科江南-开发运维  
   
签到  
   
> 18:00:12  陆周雷-农行-开发人员-北京  
   
大家好，今晚我跟大家分享一下，我现在接手的缴费中心这块的东西  
   
> 18:01:28  聚合支付_程昱  
   
签到  
   
> 18:01:58  聪明付-林鹏云  
   
签到  
   
> 18:02:38  陆周雷-农行-开发人员-北京  
   
缴费 的业务场景 就是咱们平时 在手机银行上进行缴纳水费，电费等这种场景，目前缴费中心的定位是支付系统的前置，主要负责前台展示，商户注册审批，秘钥管理等功能  
   
> 18:04:35  陆周雷-农行-开发人员-北京  
   
业务的流程： 用户进入手机银行，进入缴费界面，系统根据用户所在位置信息，提供可以缴费的项目  
   
> 18:06:43  陆周雷-农行-开发人员-北京  
   
选择相应的缴费项目，比如水费，输入缴费的单据号，传到系统后台，缴费中心生成一个针对单据号的订单号，还有缴费的项目信息，金额，返回到用户端，用户确认之后，输入密码，点击确认  
   
> 18:09:21  陆周雷-农行-开发人员-北京  
   
缴费中心，进行参数验证之后，根据缴费的项目类型，调用支付系统的相应的接口，等待返回结果，如果返回成功，那么缴费成功或失败，将订单状态和支付流水单状态修改成功或失败，将提示信息传给前台用户。  
   
> 18:11:08  陆周雷-农行-开发人员-北京  
   
针对出现的异常的情况，会进行三次重试，如果依旧是异常中间状态，那么写入到异常记录表中，系统会设置轮询任务，对异常记录进行再次查询，确认，如果依旧异常，则进行人工处理环节  
   
> 18:11:42  陆周雷-农行-开发人员-北京  
   
这块的技术架构上，springMVC+dubbo+mybaits  底层数据库是oracle集群，在  
   
> 18:13:09  陆周雷-农行-开发人员-北京  
   
订单数据和流水数据的存储上，数据库和redis都存一份，先写数据库，异步写redis，对外提供查询订单和流水功能上，先读redis如果没有，再读数据库  
   
> 18:13:47  陆周雷-农行-开发人员-北京  
   
好了，我介绍完做的这块东西了  
   
> 18:21:42  何阳-天阳科技-开发-长春  
   
你们异常时候不冲正吗  
   
> 18:23:33  何阳-天阳科技-开发-长春  
   
缴费涉及银行核心和缴费公司，你们是怎样对账的  
   
> 18:26:50  陆周雷-农行-开发人员-北京  
   
冲正  有重试和  轮询任务进行冲正 对账    
   
> 18:27:42  陆周雷-农行-开发人员-北京  
   
我们与缴费公司对账 提供了实时的查询接口，也有夜间的批量账单和流水文件下载  
   
> 18:28:22  Michael-CGB-技术经理-佛山  
   
收费的账户分行内和行外？  
   
> 18:29:29  陆周雷-农行-开发人员-北京  
   
第三方渠道公司 账户， 银行自身的用户  
   
> 18:29:59  Michael-CGB-技术经理-佛山  
   
第三方渠道公司的账户开在农行还是他行？  
   
> 18:31:17  陆周雷-农行-开发人员-北京  
   
农行   
   
> 18:31:34  Michael-CGB-技术经理-佛山  
   
我不太清楚第三方渠道公司做什么角色  
   
> 18:31:54  洋芋  
   
是什么样的节点会触发冲正呢，三次重试失败进入轮训后多久？  
   
> 18:32:14  陆周雷-农行-开发人员-北京  
   
比如 第三方渠道公司   百度上可以缴纳水费，但是具体缴纳的时候，走的这边的接口  
   
> 18:33:07  Michael-CGB-技术经理-佛山  
   
第三方渠道公司是帮忙把客户的缴费给到对应的水，电，燃气公司？  
   
> 18:34:03  Michael-CGB-技术经理-佛山  
   
扣客户账到第三方渠道公司，然后第三方渠道公司再帮忙把客户的缴费转给对应的水，电，燃气公司吗？  
   
> 18:35:39  陆周雷-农行-开发人员-北京  
   
比如 我们与支付系统约定 接口返回 status=1, des=成功，返回比如-1，无法确定是否成功支付，这个时候就是中间状态，轮询是10s 一次  
   
> 18:37:40  陆周雷-农行-开发人员-北京  
   
用户在第三方渠道公司上，进行扣款，缴费中心在第三方公司的账户上进行扣款，之后第三方公司把钱给银行，银行再把钱给水电公司  
   
> 18:39:32  陆周雷-农行-开发人员-北京  
   
用户把钱给第三方渠道，渠道给银行，银行给水电公司 就是这样一个链条  
   
> 18:47:43  Michael-CGB-技术经理-佛山  
   
（1）客户账户A:开在农行 （2）第三方渠道公司账户B:开在农行 （3）水电公司账户C:开在工行  
   
> 18:48:33  Michael-CGB-技术经理-佛山  
   
第三方渠道公司是直连农行和工行？  
   
> 18:49:41  陆周雷-农行-开发人员-北京  
   
渠道公司 走我们这边缴费接口，走的农行  
   
> 18:50:09  Michael-CGB-技术经理-佛山  
   
缴费这块我没接触过~[捂脸]  
   
> 18:50:17  Michael-CGB-技术经理-佛山  
   
所以搞不清  
   
> 18:51:46  Michael-CGB-技术经理-佛山  
   
你们的缴费接口怎么把客户的钱给到水电公司的工行账户？走大小额？  
   
> 18:51:55  何阳-天阳科技-开发-长春  
   
如果冲正超时了，你们怎么办，需要日终对账来调流水吗  
   
> 18:54:48  陆周雷-农行-开发人员-北京  
   
钱到工行账户，这块是支付系统那边做的，不是特别清楚，走的银联的接口  
   
> 18:57:25  陆周雷-农行-开发人员-北京  
   
对于冲正超时，轮询任务几次都无法解决，报警处理人工接入了  
   
> 18:58:12  陆周雷-农行-开发人员-北京  
   
日终也会对账，但是问题就比较严重了，需要对支付各个接口进行排查  
   
> 19:16:22  陆周雷-农行-开发人员-北京  
   
要不 今天就分享到这？ 我有点事要出去了哈  
   
> 19:16:28  小穆-至尊商务-技术-郑州  
   
缴费用心负责商户注册审批，这个商户注册是什么业务  
   
> 19:16:39  小穆-至尊商务-技术-郑州  
   
看到可以回复的[呲牙]  
   
> 19:17:49  小穆-至尊商务-技术-郑州  
   
另外订单放到先放到数据库在放redis  
   
> 19:18:54  小穆-至尊商务-技术-郑州  
   
虽然并发可能不大 为何不先入缓存 缓存在异步入库呢  
   
> 19:19:20  陆周雷-农行-开发人员-北京  
   
商户管理就是对渠道公司的管理， 就是录入商户的基本信息，负责商户信息的核实，审核，分发和管理公钥，私钥，等等  
   
> 19:24:23  小穆-至尊商务-技术-郑州  
   
我能这样理解不，渠道公司就是你们的代理  
   
> 19:25:23  小穆-至尊商务-技术-郑州  
   
具体和水费公司签约是你们，如果其他第三方想使用你们的缴费通道就需要接入你们的接口  
   
> 19:26:34  陆周雷-农行-开发人员-北京  
   
渠道公司是我们的代理 对的   
   
> 19:28:54  小穆-至尊商务-技术-郑州  
   
明白 我们现在就是代理角色 使用的别人的缴费通道  
   
> 19:29:35  小穆-至尊商务-技术-郑州  
   
流程搞清楚了 感谢分享  
   
> 19:31:10  陆周雷-农行-开发人员-北京  
   
先写库 后异步到redis，  是确保记录的更好的完整性， 先写redis后异步入库，性能更好，高并发读，压力小。就看系统目标 取舍了  
   
> 19:32:19  小穆-至尊商务-技术-郑州  
   
明白了 再次感谢  
   
> 19:34:22  陆周雷-农行-开发人员-北京  
   
[握手]  
   
> 19:43:19  程琳Wa-杉德支付-产品-上海  
   
感谢陆童鞋的精彩分享??????[强][强][强]  
   
> 19:43:45  王新-笑脸金融-架构-北京  
   
感谢分享！  
   
> 19:44:19  聚合支付_程昱  
   
很精彩[抱拳]  
   
> 20:06:06  七夜  
   
精彩  
   
> 20:12:50  青椒-众之金服-产品-成都  
   
[强]  
   
> 20:21:44  丁志伟-骏易科技-架构师  
   
[强]  
   
> 21:11:57  鄢志明-聚和付-副总-深圳  
   
[强]  
   
> 21:20:29  王月卿～华胜～产品经理～北京  
   
[强]  
   
> 21:27:12  吴静南-中移电商-产品经理  
   
[强]  
   
> 21:34:25  Merry(黄燕)  
   
[强]  
   
> 22:01:03  鄢志明-聚和付-副总-深圳  
   
[玫瑰]  
   
> 22:09:51  七夜  
   
[强]  
   
> 22:34:46  于江宁  
   
20171231-银联信用卡分期  
   
> 22:39:48  李雄峰  
   
感谢@于江宁-银联电子 支付-产品  于总的分享。   
   
> 22:39:53  程琳Wa-杉德支付-产品-上海  
   
[玫瑰][玫瑰][玫瑰]于总分享的干货  
   
> 22:43:50  于江宁  
   
[握手]  
   
> 22:58:19  付云-农业-开发-成都  
   
中国现代化支付系统--总体.ppt  
   
> 22:59:52  潘啟金-找钢网-产品TL-上海  
   
[强][玫瑰]  
   
> 23:01:43  ??刘莎  
   
[玫瑰]干货么  
   
> 23:02:20  付云-农业-开发-成都  
   
银行卡BIN识别表,包含6000种,Bin_2017-12-15.xls  
   
> 23:05:01  付云-农业-开发-成都  
   
最近在学电商模块，水深啊  
   
> 23:42:00  MyCity  
   
感谢分享！  
   
> 23:42:40  医美消金-pm-上海  
   
感谢分享！[强]  
   
> 23:43:47  贾春亮  
   
感谢[强]  
   
> 23:44:58  王月卿～华胜～产品经理～北京  
   
感谢分享[强]  
   
