# 一、主题分享
大家好，今晚我给大家分享一下我们目前移动端支付功能实现的过程，整个项目过程中踩了很多坑，希望能给大家一些案例的启示。  

背景：  
公司主营业务为农村B2C电商，业务的开展基于自主深度定制的Android系统，搭配硬件推广设备推广，通过设备的唯一性与其内置的相关应用锁定用户粘性，前端通过app与用户发生交互，后端通过商户入驻系统、云联供应商系统，进销存系统，大数据系统配合业务开展，实施整个电商的交易活动。在此推广运营过程中，因设备成本及活动力度对入户影响较大，故此在现有设备基础上，通过移动端的配合，拓展潜在设备外用户群。  
因群体属性特殊，对互联网的接受度较差，因此单纯的功能实现未必能保证用户完成正常的交易过程。所以在这个基础上又结合目前三方支付功能推出代付模式，结合线下推广员社群模式促进交易的完成。

现有的支付模式主要有三种：  
> 1. 余额系统支付
> 1. 微信支付宝三方支付
> 1. Mpos刷卡支付

以下为团队技术经理协助总结的实现过程：  
1.在客户端服务器数据传输安全方面，首先服务器搭建SSL服务器，SSL在传输时已经进行加密传输；客户端与服务端通讯使用类似支付宝统一网关的方式，对请求和响应的所有数据进行加密传输，并验证数据传输过程中有没有被篡改(签名是否正确)  
2.在用户体验方面，用户支付成功后服务端立刻返回支付结果。支付成功的后续操作使用MQ消息总线的方式异步处理(如通知卖家支付成功、发送短信给用户提示支付成功、推送成功订单到大数据系统进行分析、推送销售系统进行用户购买行为和推荐商品分析)  
3.在便捷性方面，提供代付功能，代付发起人可使用微信、支付宝、QQ等方式发送代付消息给好友，好友使用支付宝或微信的H5网页支付方式进行支付。代付人发出代付消息后与服务器建立socket长连接，待好友付款成功后服务器推送支付结果给代付人。提升用户体验  
4.因存在部分大客户，支付功能方面提供了三方配置服务，用户付款成功时，资金直接进入商户对应三方配置的公司账户，平台仅提供支付功能的实现及记账功能。  
总的实现过程，我做了一个简单的示意图。如下

![20180702_213412](http://static.cocolian.cn/img/20180702_213412.png)  

以上就是我今晚的分享，谢谢大家。

# 二、Q&A
**Q:用户余额是做了银行存管吗？**  
A:对 资金做了存管，是青岛公司，目前只是在主营电商业务，部分金融相关业务在尝试，还没接触网贷这部分

**Q:硬件嵌入android 推广？**  
A:自主研发的硬件设备，搭配深度定制的Android系统，基于底层改的。外观类似pad plus  
S:明白了，教育智能电子平板？  
A:带操作系统的 Android系统一体机  
S:看了一下，不错的商业模式

**Q:电商平台没有牌照，也可以做资金银行存管吗？**  
A1:跟牌照没啥关系的

**Q:青岛的互金行业怎么样**  
A:跟行业普遍现状没太多出入，也是有些乱象丛生，青岛地区的互金公司大多都是北上广一些集团的分公司。
