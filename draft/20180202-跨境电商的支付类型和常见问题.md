# 一、主题分享：跨境电商的支付类型和常见问题
今天主要介绍的是当前跨境电商使用的主要支付手段及流程以及针对多站点支付业务的监控方案。
## 1、业务背景
**是目前中国最大的跨境B2C电子商务公司之一，目前拥有自营网站27个，其中海外知名度最高的为 xxx.com，主要市场为欧美、南美、俄罗斯等地。由于站点较多，目前支付项目独立出来作为服务化部门对所有网站站点的支付功能采取统一平台管理。由此带来的好处是统一管理，但同时也带来了后台统计表逻辑复杂，难以及时的监控发现潜在的问题的缺点。
## 2、目前主要的几种支付手段
### （1）国际信用卡支付
目前最主要的支付方式是国际信用卡支付，其优点是对接渠道商可以把支付集成到自有页面，可控性高用户体验也好。</br> 
我们目前对接了7家支付商的信用卡渠道，以费率、支付成功率以及稳定性作为评分标准，人工对渠道进行质量评估，并以此为依据进行人工路由调整。</br> 
先放一张国际信用卡业务的基本流程图</br> 
![20180202_180448](http://wechat.lixf.cn/img/20180202_193146.png)</br> 
从流程图中可以看到在提交支付渠道之前会先调用风控网关进行事前风控，风控返回的结果分为三种状态accept，review，reject（也就是常说的高中低三等级风险）；对于前两种状态都会抛给支付网关，对于风控结果为review的订单由渠道或发卡行进行判断是否可以授权支付，一般中风险的订单会要求用户进行3D验证。根据渠道侧返回的通知，如果授权成功，会通知网站将订单状态从waiting for payment改为pending，防止用户重复支付。</br>

- 3D验证，3D验证是发卡银行提供的身份验证功能，类似我们常用的短信验证，需要将用户重定向到银行页面。对于是否开启3D验证这一步是需要根据fraud率进行斟酌的，因为增加3D往往也意味着部分有真实支付意愿用户的流失。影响大的情况下可能减少3-5个点的支付率。
- 目前使用的第三方风控主要使用的是评分模型，对不同风险点进行评分并得到一个总分数。风控结果会将各项的评分及总分返回，基于此数据及平台自有的支付历史数据可以总结出一些有价值的信息。基于以上原因，为了提升支付成功率以及节省成本的考虑，我们目前正在计划增加一套基于规则的自有的风控体系，主要包括：异常行为拦截、高风险人群画像及高风险地区分析、黑/白名单数据等。针对一些可识别的高风险用户直接拒绝交易，减少风控网关使用费用；对风控返回review（中风险）的用户基于历史支付数据及往期3D规则进行判断是否进行3D验证，从而减少支付流程提升支付成功率。
- 分享一个最近接入支付遇到的坑：通常同一个渠道商下可能会同时接入信用卡及本地支付，而在支付结果的异步通知中并没有字段标识支付方式，开发人员在不熟悉业务的情况下可能在接受异步通知后将其归至该网关同一支付方式下，导致付款单出错。当时的解决方案是在提交支付时再在附加字段中加入支付方式标识并要求渠道商在异步通知时返回该字段，以此为准进行判断。
### （2）本地支付
除了国际信用卡外，本地支付也是目前重点方式之一： </br>
本地支付分为线上支付以及线下支付，有时候同一个支付方式同时支持线上及线下付款（线下付款主要是渠道商和当地便利店或邮局合作提供线下支付）其优点是有利于进入市场提供本地常用的支付方式，完成支付。</br>
除此之外还有一种使用频率很低的方式就是直接提供公司账号，让用户去银行转账后由账务组进行确认。</br>
## 3、总结
以上就是基本支付内容，如前所述由于网站众多，且每个网站包含多个语言的站点。仅仅对接口访问等基础指标进行监控只能保证功能可用，但是很多时候一些非致命的原因也可能导致支付率下降，比如前面提到的3D规则设置或者是涉及面较广的前端优化等等。尽管后台提供了实时性较高的报表可供查询，但是在工作强度高，或者问题不明显的情况下往往难以及时发现。因此在和业务组沟通后我们设计了一套基于历史数据的业务监控系统。简单来说就是在区分工作日与非工作日的基础上，对前N日的数据在排除异常数据后取每小时的业务数据均值作为预测值与当前时间段的业务数据进行比较，当实际值连续X次低于预测值Y%时进行告警。</br>
当然以上是比较简单的描述，这里面还涉及业务高低峰处理，异常数据处理等问题。下图是基本埋点数据及告警规则的说明</br>
![20180202_180448](http://wechat.lixf.cn/img/20180202_193618.png)</br> 
![20180202_180448](http://wechat.lixf.cn/img/20180202_193622.png)</br> 
# 二、Q&A
Q1:请问国际信用卡的支付业务，是直接对接的发卡行还是对接的卡组织啊?</br> 
A1:对接的是支付渠道商，像Adyen，Oceanpay这些公司。</br> 

Q2:做外卡支付，如果出现掉单或盗刷，处理方式和内卡有什么区别吗？</br> 
A1:如果出现漏单目前一般都是因为异步通知接收失败导致的，我们有主动查询的功能去确认付款单。信用卡方面如果出现盗刷首先看是否有进行3D验证结果是否符合责任转移，如果符合责任转移的话由发卡行处理，如果不符合责任转移，用户如果认为存在欺诈要求退款我们也只能退款并将该用户列入待观察名单，后期观察是否存在恶意退款的嫌疑。</br> 

Q3:7家支付渠道商是哪几家？通道支付成功率怎样？</br> 
A1:像之前列举

Q4:一般这类通道的费率多高呢？</br> 
A4:费率是由业务组专人去对接的，这个不太清楚.</br> 
