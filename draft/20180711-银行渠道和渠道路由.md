## 一、主题分享
支付机构的一个比较重要的角色是帮助入网商户完成资金的转移，将用户银行卡中的资金转移至入网商户的银行账户中，为了完成该资金转移过程，就需要对接银行，银联等机构的资金渠道。

### 1.1 支付渠道
**按照业务类型划分**，接入的渠道主要包括网关、快捷渠道、代扣渠道和代付渠道。前三种主要用于入金业务，代付渠道用于出金。

**网关支付**</br>
网关渠道需要用户跳转银行网关进行支付，用户体验比较差，失败率也比较高，因此逐渐被快捷和代扣替代。

**快捷支付**</br>
因此重点说下快捷和代扣渠道，快捷渠道包括两个关键步骤，一个是签约，一个是支付。签约时一般会验证四要素信息，签约短信验证码。这些信息验证通过以后，才算签约成功，对用户的体验是绑卡成功。

绑卡成功以后就可以调用快捷渠道的支付接口完成扣款。扣款的资金流是将用户银行卡中的资金转移到支付机构备付金并最终结算到商户的银行账户中。

另外，快捷渠道一般也会有一个退款接口用于处理商户或者用户发起的退款操作，资金会原路返回。

**代扣和快捷区别**</br>
而代扣渠道和快捷的主要区别包括
- 代扣可能没有签约接口，就算有签约接口也不会向用户的预留手机号发送短信验证码。
- 代扣接口的验证要素可能会比快捷少一些，可能会存在有卡号就能扣款的情况。
- 另外，代扣渠道一般都没有退款接口。代扣交易对应的退款，一般都会走代发渠道，将用户支付资金原路退回至银行卡中。

**代扣和快捷还有一个区别**，代扣交易手续费一般都是按笔去收取，快捷手续费都是按照费率收取。也正因为此，小额交易走快捷渠道会相对便宜些，大额交易走代扣渠道会相对便宜一些。

目前，各个支付机构一般都是在用户绑卡时走快捷渠道，但是再支付时就可能会走快捷也可能会走代扣，这在体验上对用户是无感知的。这就是监管和银行常说的乱象，把代扣包装成快捷走交易。因为代扣的初衷是向指定账户定期发起扣款，是有对应场景的。比如公共事业缴费等。

代扣和快捷这么大的区别，因此支付机构就需要做入款渠道路由系统，以便能够判断交易走那些渠道更合适。

**代付**</br>
代付业务在资金流上是把商户银行账户的钱代付至用户银行卡。这个过程其实包括两步，一是商户完成充值，将其银行账户的资金充到机构备付金账户，然后通过代付接口把备付金账户的钱代付至用户个人银行卡。

代付渠道主要包括同行代付和跨行代付</br>
- 同行代付走的是行内系统，收款行和付款行是相同的。
- 跨行代付的收款行和付款行是不同的，一般是走央行的大小额系统，银联代付和网联代付。

还有央行的超网系统，走央行的系统进行出款，一般只能通过支付机构的主存管银行完成对接和相应出款行为。通过合作行的出款一般都是同行出款。
### 1.2 渠道路由
因为不同的扣款渠道，手续费不同，支持的银行不同，支持的卡类型不同，业务类型要求不同(比如银联渠道会走mcc的限制，代扣渠道会有商户业务类型的限制等)，因此怎么把交易送到最合适的银行渠道，就是渠道路由要做的事情。

这个是一个多对多的关系，多笔交易对应多个银行渠道，渠道路由需要根据一定的路由规则将其进行匹配。

一般的渠道路由会包括两类规则，一类是筛选规则，一类是优选规则。</br>

**筛选规则**</br>
- 将不适合这笔交易对应的银行渠道筛除掉，保留可用的。比如，有些渠道仅支持贷记卡的扣款，那如果是借记卡的交易请求，那这个渠道就需要筛除掉。
- 一般都会包括：卡类型筛选、支持银行筛选、限额筛选、支持账户类型(对公or对私)输出、商户黑名单筛选等。

**优选规则**</br>
- 是把从所有剩余可用渠道中选择一个最优的银行渠道用于完成该笔交易请求的支付。比如，成本优选规则，一笔交易走哪个渠道成本相对更低，看起来选择该渠道就会更合适。就像刚才举的代扣和快捷手续费差异的例子。大额交易适合走代扣，小额交易更适合走快捷。
- 一般都会包括：成本规则、成功率优选规则。

-------

## 二、Q&A
Q1：“通过合作行的出款一般都是同行出款”，这句话能否解释下？</br>
A1：通过合作行的出款一般都是同行出款。机构的合作银行包括两类：一类是存管行，一类是合作行。存管行开立的备付金账户是存管户，一个省可以开立一个。存管户可以做跨行出款，权限最大。合作行开立的户是备付金合作户，只允许做同行出款。这个是人民银行规定，所以，合作户出款只能做同行出款。同行出款对支付机构有两个优点，一是成功率高，速度快，走的是行内系统；二是手续费一般都是免费的。缺点是需要对接合作行的银企直角联接口，接入成本高一些。

Q2：请教几个问题，路由优选规则里，最优银行渠道规则怎么样的？商户一般通过何种方式把资金充到代付对应的备付金账户的？</br>
A1：优选规则一般包括成本优选，成功率优选，还有一些会牵涉到套银联码的一些优选等等；这个最好是根据公司的场景来定。商户充值一般是两种办法，企业网银转账，一种是对公代扣；对公代扣速度快，体验好，但是只能做同行代扣。最近这种代扣也都在被关停。

Q3：如果同时有银联和网联两条渠道，在切换渠道的时候用户是无感知的，但是上送信息和签约序列号是不同的。如果用户A在银联签约，切换到网联还需要再次签约的话，这样用户就会很蒙逼，为什么需要二次签约，请问这如何解决？</br>
A1：这个问题没有网联的时候也是存在的，用户在签约一次就好了。不过因为这是一个共性问题，所以银行都在改造系统解决，在银行称这个事情是三库合一

Q4：请教个问题：快捷绑卡的时候如果走银联绑卡渠道，信用卡的CVN2和有效期这些信息不会存，但是当用户二次支付的时候，需要验证信息，请问如何解决？</br>
A1：银联会存，他们存是合规的。在支付的时候可以让他们补充，具体跟对手银行沟通下就可以了。

Q5：我的意思是对于三方公司上送交易验证的时候需要验这两个信息，但是又不能存（因为合规），那如果要验证的时候，这个问题如何解决？</br>
A1：银联会存呀，需要的时候银联把存储的信息会自动补填上。直接找银联沟通就可以了。

Q6：对公代扣充值只支持同行代扣，一般商户和支付公司合作，只需要充值到一个备付金账户吧，不用充值到多个备付金账户吧，这样支持同行代扣也没有问题，因为只有一个银行。</br>
A1：一个就可以，支付机构可以内部调拨各个备付金户的资金，商户不用关心。

Q7：如果银联和网联通道都接了的话，协议支付签约的时候是不是可以往两个通道都发送，然后存两个协议号，在支付的时候根据通道选择协议号就可以吧，这样是不是对用户也是签约一次</br>
A1：银联和网联都会返回一个协议号的，到银行那里就是两次签约请求。银行就会发送两次短信验证码，用户是有感知的。

Q8：银联的协议支付有什么优势么，现在央行主推的是网联了。</br>
A1：央行中立吧，银行主推网联。

Q9：网联现在对接的银行不多吧，感觉没银联新无卡快捷的系统接入的银行多。</br>
A1：网联支持的银行对，银联新无卡少。银联全渠道多。</br>
A2：全渠道不好用…也没有协议签约</br>

Q10：银联全渠道是新无卡系统的补充方案，互补用起来还是不错的</br>
A1：全渠道是老无卡，新无卡是老无卡的替代，不是补充。过渡结束后会替代

Q11：新无卡和老无卡有什么区别吗？</br>
A1：新无卡更标准一些，统一验证四要素，也弱化商品类别码的概念。老无卡比较乱，验证要素借贷有差异，不同的商品类别码费率会有不同；另外老无卡由银联统一定价，新无卡则因为银行同步，价格也会有差别；老无卡会有套码的空间，新无卡没有。所以是弱化，不和成本挂钩就无关紧要了。

Q12：请教一下，银行在接了网联后，需要单独和支付公式进行商务沟通吗？</br>
A1：网联暂未统一定价，协议有机构和银行单独签

Q13：再问一个问题，支付公司接了银联和网联，如果也和某家银行(这家银行也同时接入银联和网联)签了，什么时候走银联还是走网联，是由交易路由决定的吗？还是有什么规则？</br>
A1：不管什么时候，交易走哪个渠道都是由渠道路由来决定的。不过，彻底断直联之后，渠道路由就会非常简单，因为两个渠道能力基本没差别。也不需要做太多筛选和优选了。

Q14：快捷现在还能走直连吗？</br>
A1：没有强制断，暂时还可以</br>
A2：也就是现在快捷可以网联、银联、银行直连了？</br>
A1：可以这么理解</br>

Q15：网联和银联有网银产品么？</br>
A1：银联一直有银联网关，网联也已经开发</br>

Q16：如你所说支付公司实际输出快捷支付，但是底层走代扣，对于用户会收到扣款短信么？</br>
A1：扣款成功通知短信是银行为用户提供的服务，当用户银行卡余额发生变动时，就会收到变动通知短信，跟走什么类型扣款渠道没关系。</br>
>断直联断的是机构和银行间的业务往来，非持牌商户和银行的业务不在断直联范围。机构和银行间直联对监管造成了比较大的影响，比较典型的例子是支付机构可以把用户之间的转账业务转变成一笔同行支付业务和一个同行代付业务。转化前的转账业务是要过央行的系统，转化后就是两笔行间业务，人民银行无法监管。不断直联的话，支付机构变相做了一些清算组织的事情，人民银行认为乱象比较多，需要清本正源，众神归位

A2：洗钱的太多</br>
A1：嗯，是的。我的理解是，洗钱应该都是有一定特征的，可以被反洗钱系统筛选出来。所以央行需要交易过他们自己的系统，这样才有筛选出可疑交易的可能性。</br>


