# 一、主题分享
大家好，我们公司主要是经营智能收银台业务（实体收银台），我负责公司支付条线产品工作，在这里和大家介绍下我们收银台支付相关业务。可能会讲的比较浅，望各位指正，也希望能抛转引玉。 

1、我们目前主要经营实体收银台及各类收银终端，主要有收银台、协同机、智能pos、微店铺、扫码点单、聚合收款等不同的终端。收银台收银过程大致为到店-（选座）-点单-结账-支付，目前支付的时候支持多种支付渠道，如：支付宝、微信、翼支付、和包支付、富友聚合支付、银商聚合支付、pos刷卡、预付卡、现金等。

2、由于终端比较多，支付通道也在不断的升级和增加，那如何有效的管理这些通道呢？首先所有这些支付渠道（除pos刷卡外）均由服务端来进行对接管理。终端可以通过两种方式对接支付，一种是调用服务端包装好的接口来使用支付。另外一种是在终端接入由服务端推出的统一收银台（收银界面）。

3、走接口方式的只是从服务端调用支付服务，终端系统支付界面及支付流程由终端自行封装，服务端只负责提供服务调用以及收集支付后的相关流水数据。走统一收银台方式的，终端系统只需要集成相关的收银台sdk即可，界面及支付流程等均不需要重新开发，另外支付数据同样在服务端进行收集。

4、对于统一收银台，可以在支付后台进行配置。由于一个商户账户下，可以有若干个终端系统，那么支付渠道和终端系统如何去匹配？首先，会有相应的支付配置后台，可以为每个商户账户开通若干支付渠道，同时配置上该商户的相关参数，目前资金走代收和商户自收两种，商户自收的需要由商户在渠道测进行开户，然后在相关的终端平台上启用该渠道的支付方式。启用后，即可在统一收银台中使用该渠道提供支付服务。当然也会配置相应的路由规则，比如指定某商户使用固定的渠道路由，多渠道的分流设置，渠道限制规则，优先规则等。这样配置好后，相关终端就可以使用对应的收银台了。  
简易的画一下逻辑  
 ![magic](http://static.cocolian.cn/img/20180815_193401.png)
 
5、对账，对于代收部分，我们按照商户的需求，按固定周期，如按日生成对应的对账文件，对账主要是业务侧和渠道侧流水进行对账，需要从渠道侧下载对应的对账文件，进行双向对账。然后生成对账文件，及问题账目，处理完成问题账目后，目前问题账目走人工处理，完成对账。

6、关于退款，目前支付支持组合支付，组合支付会根据支付的渠道生成若干流水，当最终完成所有支付时，该笔订单完成支付。组合支付退款时，若全额退款，则对所有通道原订单按照支付金额进行一次退款。若部分退款，则可以由人工来选择对于通道，不过不能超过该通道的支付金额。退款时，同样按照通道生成新的逆向支付流水。

今天的分享就这么多了，谢谢大家。
# 二、问答环节

**Q1【走统一收银台方式的，终端系统只需要集成相关的收银台sdk即可，界面及支付流程等均不需要重新开发，另外支付数据同样在服务端进行收集。】请问下，这个能说一下具体的运用场景么？比如扫码枪什么的？感觉理解起来有点抽象**
- A1好的，收银台是一个实体硬件，在收银的时候，会有支付选择页面，你可以理解为这个页面所有的支付方式、支付流程及后续的支付渠道，都是由支付后台统一管理，这个支付页面，可以通过客户端直接对接接口来做，也可以用我们支付组这边提供的一个类似的插件
- Q1主要场景是b扫c么？
- A1对，主要是b扫c为主。另外还包含预付卡，现金等
- Q1那你们的组合支付支持怎么组合呢
- A1还有微店的话，是c端发起支付，比如h5支付，公众号支付之类的
- 比如100元，可以用支付宝支付50 ，微信支付30，预付卡支付10，现金支付5，抵扣5。类似这样的支付。一个订单会对应多条渠道流水
- Q1你们的双向对账是指核心与业务侧对和核心与渠道侧对？还是只是渠道与业务侧对？
- A1对账还是业务侧和渠道侧对，我指的双向对账，是说先通过业务侧和渠道测对，在通过渠道侧和业务侧对，这样比对，能得出两边所有差异账目
- Q1求讲差异账目的后续处理[强]
- A1[支付系统的对账处理与设计](https://mp.weixin.qq.com/s?__biz=MzI4OTQ3MTI2NA==&amp;amp;mid=2247483728&amp;amp;idx=1&amp;amp;sn=e358e7770a2f244c815cd6554f6b6ea5&amp;amp;chksm=ec2fef1fdb586609daaf50ccbb6cca9c60e904eaa7b5e4bac5d33773027afeb7b8ac0111d9ca&amp;amp;mpshare=1&amp;amp;scene=1&amp;amp;srcid=0815XqQajSepggNtopzuKT6m#rd) 之前群里有人分享过，这个文章写得很详细了， [呲牙]可以看下。