#### 一、背景说明

296号文规定，使用静态条码的，同一客户单个银行账户或所有支付账户单日累计交易金额应不超过500元。我们限制了我们行单个用户单个渠道日累计限额，本身我们为商户提供了商户端APP，可以通过扫客户的付款码完成超过500元的交易。但是因为部分商户的收营员不愿意装APP，或者商户觉得使用APP不方便等原因，我们针对各种支付场景，也了解了一下市面的大概情况，对接了一些硬件设备。下面简单的介绍一下我们对接的各种设备的应用场景及对接的方式。

#### 二、各种设备的应用场景介绍
我们对接的设备主要包括扫码盒、动态扫码台、手持扫码枪。
##### 1、扫码盒
###### 1.1 什么是扫码盒
扫码盒就是放在收银员柜台，通过扫客户的支付码自动完成支付并进行语音播报的设备，主要有三种基础版、兼容版及加强版。
###### 1.2 分类及应用
（1）基础版需要在客户的收银机或者PC机上安装一个我行的安装包，可以通过手动输入支付金额、抓取屏显、抓取串口等方式获取支付金额，然后调用我们的被扫支付接口，如果出现需要客户输入支付密码的情况，则定时调用查询接口，查询该笔订单支付状态，完成支付，支付成功后进行语音播报。

（2）兼容版是即插即用的，盒子的功能就是扫码，发起支付可以通过我行PC版的商户端发起支付，支付完成后进行语音播报。

（3）加强版是盒子可以通过wifi、3G或者宽带接入互联网，盒子外接键盘，商户在键盘输入金额后，语音提示客户扫码，完成支付后进行语音播报。
###### 1.3 实现方式
实现方面，我们根据付款码的规则，调用不同三方的刷卡支付接口完成交易，如果支付是异步的话，由于无法回调通知终端设备支付状态，所以设备需要主动调用我们的查询接口确认支付状态。三种盒子都有各自的应用场景，价格方面也不一样，大家可以根据自己的情况进行选择。

##### 2、动态扫码

###### 2.1 什么是动态扫码台

动态扫码台就是放在收银台，客户主动扫描设备上的二维码完成支付的设备。

我们接入了两种，一种是只支持主扫（客户扫设备生成的动态码）的，还有一种是既支持被扫也支持主扫的。
###### 2.2 应用场景
这种设备主要针对有些商户本身偶尔有一笔金额稍微大的交易，大多数情况下还是使用静态二维码就可以满足需求，且商户不愿意去扫客户，嫌麻烦的，我们一般给商户配置这种动态扫码台，这种扫码台有一个显示器。正常待机情况下，显示的这个商户的静态支付二维码，每日每个客户累计500元限额，如果客户单笔或者累计额度超了，商户可以通过设备上的键盘输入金额，调用我行获取聚合码接口，显示二维码让客户来扫。动态码扫前、支付后都有语音提示及播报。
###### 2.3 实现方式
实现方面，聚合码还是通过调用各支付渠道类似微信公众号支付接口，然后通过查询确认支付状态。第二种支持被扫、主扫的设备的实现都基本一样。
##### 3、手持扫码枪

手持扫码枪实现上与加强版的扫码盒类似，只是多了个键盘、屏幕、电池，样子与旧款的手机类似，可以通过3G、或者wifi接入互联网。

另外需要注意一点，这些设备里面除了加强版扫码盒，其余设备均可在设备上或我们的商管平台发起订单状态确认的请求，硬件设备是通过在设备上记录近100笔订单号，我们的商管平台本身就有单笔订单的状态同步功能，也可以手动输入订单号的方式发起查询确认订单状态。
##### 4、其他支付场景硬件
我们还对接了一些行业的自助终端，比如天然气自助购气机、客运站自助售票机、人行征信系统查询机、医院自助挂号机等，这些在支付方面的实现与上面各种硬件设备的原理类似。

#### 三、设备对外接口介绍
设备方面对外提供的接口主要包括：

获取商户信息接口；主要是获取商户名称、门店名称、加密key、静态二维码等；

刷卡支付接口；

动态二维码接口；

订单查询接口；

订单关闭接口。

[附件：扫码支付终端设备列表简介](http://note.youdao.com/noteshare?id=619e47d62feb87c917aa00a61914c7a9)

上述附件是我们目前对接的一些设备的简单介绍

设备对接支付仅仅是整个设备对接部分很少的一部分，设备的入库、出库、撤机、换机、巡检流程、安装流程，报文安全、设备交易监控、设备软件升级、防切等等，还有很多工作，在这里就不一一介绍了。

 
