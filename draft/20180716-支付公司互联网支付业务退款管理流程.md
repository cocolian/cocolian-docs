# 一、主题分享
今天我给大家分享的是互联网支付中的退款业务的资金处理流程。

互联网支付的资金处理主要分三大类：**++收款、付款、退款++**，前面两个大家或多或少都有过分享，今天我来跟大家聊下退款，由于工作范围的原因，仅限于流程方面，后台技术层面欢迎各位专业人士补充。

我们先把退款分成三类：  
> 1. 联机原路退款；
> 1. 脱机原路退款；
> 1. 线下打款退款。

1.联机退款就是对于有联机退款能力的银行通道，支付公司通过退款接口将退款请求发给通道，通道进行原路退款。退款过程中会对这笔退款关联的原支付交易订单的订单号和金额进行校验，如果发现没有原支付订单，通道会报错，如果发现退款金额超过了原支付订单金额，也会报错。比如你在国美电器买了10件家电，合并一个订单付款，支付订单金额10万元，你可以对其中一件电器进行部分退款，也可以分10次把电器都退了，但最多给你退10万元。  
2.脱机原路退款：对于不支持联机退款的通道的退款、通道长款的支付订单，或者由于各种原因导致联机退款失败的订单，有的银行通道提供了脱机退款的功能，即需要人工登陆通道的自服平台，手工输入原支付订单号和退款金额，即可发起原路退款，大部分通道支持单笔退，有的通道可以支持上传文件批量退款。  
3.付款退款：对联机退款、脱机原路退款都不能退的退款，比如银行通道关闭，持卡人的原银行卡注销了，就需要取得持卡人的银行卡信息，用代付通道付款或者用银行网银进行共对私的打款来退款。这需要获得持卡人的姓名、卡号等信息，对快捷类的交易，支付公司的系统里有这些信息，可以直接按此信息付款，其他的比如扫码类没有银行信息，就需要跟商户要或者客服外呼来取得。

以上是退款的方式，退款有一个比较麻烦的问题就是超额退款。即某个商户当天没有正向交易或者正向交易小于退款，如何处理的问题。一般银行通道的退款规则是必须当天的正向交易大于退款金额才能退款，否则不允许退款。这个问题在我们公司比较突出，我们主要是给全国各地的国美电器门店做支付服务，有的门店一开门就来一个退货的，按一般的规则，这笔就没法退，只能等着有人来买电器，且金额超过这笔退款金额才能退，那顾客就会投诉了。对这样的问题，一般支付公司是跟通道谈好，以支付公司为一个主体，形成一个资金池，只要这个池子里的正向交易够，通道就让支付公司旗下的商户退款。如果某个商户全天交易净额是个负数，那会比较麻烦，支付公司总的资金池是正数，但这个商户的结算款是负数，商户应该给支付公司钱，没法给商户正常结算，这样的情况，就需要支付公司的结算系统对这笔结算款暂时不处理，然后等次日或者过两天有正向结算款了再进行汇总轧差结算，把几天的正向和反向一起结算。当然这种模式只会针对大商户或者优质商户，实际是给商户一个授信额度，对一般商户支付公司的账户体系就直接用正向交易和退款金额校验来拒绝退款了，或者让普通商户在其开在支付公司的支付账户里留下或者充上一笔钱，专门用做这种退款使用，当其正向交易也就是待结算款不足时，直接从支付账户余额退款，这样的退款不会进入T+1日的结算款中。  

我的分享完毕，谢谢！

# 二、Q&A
**Q:现在退费转付款合规么？？**  
A:合规性应该没问题，跟网银付款差不多。

**Q:想问下银盈通与国美之间是否有手续费？  
如果有手续费，如果退款的话手续费是否退还？**  
A:我们是收国美手续费的。  
退款都要退手续费的

**Q:如果当天正向交易金额不足，是否能以国美对公户预存一笔钱，方便退款？  
例如用户一个订单下有10款商品，总金额10W，分10笔申请退款，因为有支付手续费，那么支付手续费只能是平台自己兜底亏损了？还是会从商户10W里面扣掉？**  
A:我们目前不能从商户银行账户扣钱。  
退款手续费是在结算款里的。  
S:用户购买国美商品，正向交易的资金最终还是到国美对公户的；如果国美直接冲一笔钱进去，用于处理退款用户体验不就提升上去了吗？  
国美那边对公户是只设立了一个吗？还是收支全部分开结算的呢？  
A:优质商户也可以在支付账户留钱退款，不留也能退，采用多日扎差退款的方式  
S:汇总轧差结算能否举个例子协助理解？  
国美收支全部放一起，又存在实时退款，感觉这个就是分开也对不平哎；  
A1:的确会有不平的  
S:这种情况，退款不要做实时的应该比较好对账  
A1:待清算款项小于退款金额就挂帐了。要么做个轧差余额退款，余额大于0才能退。要么从结算账户余额扣款做实时。或者是从结算账户冻结额度+未结算流水大于退款金额也可以。不然会产生商户退款跑路的风险。  
A:退款发起时候要走一个商户账户冻结的过程，发给通道，通道返回成功再解冻从商户账户下账，失败就解冻。但一般支付公司是保证退，走完三个方式都不行的基本没有。  
A1:不过你们如果是专门给国美的自营店做支付收单的 其实可以设置一个总的垫款户做实时退款，反正也不怕商户跑路。  
A:对，我们给他们是无条件退。  
S:而且垫款户你们还能多赚一笔垫资手续费。  
A:国美有的条线可以给保证金，有的就只能我们垫资。

**Q:问一个问题，现在通过网联接入一家银行，针对入款交易银行是按照两场结算批次对机构做资金结算。但是对退款交易，资金是实时从备付金账户扣减。这样在处理对账的时候总是无法对平，这种情况如何处理对账呢？**  
A:网联的场次增加了，但也应该是汇总扎差结算的。  
S:网联工行不是扎差结算的，协议支付12点结算一次，24点结算一次。退款交易是实时在备付金账户扣减。  
A:网联的收单目前我们只是完成任务，没怎么跑，好像听说退款有单独扣。  
S:是的。这种情况怎么处理对账呢？协议支付和退款拆分对账么？  
A:对账你们是人工还是系统自动跑？  
S:系统自动  
A:我实际没对过这类账，但也遇到过比较复杂的通道，分开对是大的思路。人工会比较麻烦，系统自动就要单独做逻辑。网联的培训给我的感觉是他们也是摸索阶段，我们可以提需求，他们愿意优化，可以跟他们提下这个退款的问题。  
A1:我们这个系统好似就没对手续费。只对交易。手续费可能是其他系统对。

**Q:如果部分退款，手续费是全额退还是部分退呢**  
A:部分退手续费按比例返还。

**Q:第三种退款，那是自己打款，手续费肯定不退吧？那样是否是自己承担了，清算的是否怎么计算？**  
A:打款退款手续费有的公司不会退，太复杂，商户也不会太纠结，金额不大。  
A1:退手续费，应该是按比例的，部分退款就退部分手续费。  
S:我们的客户就很纠结。这种情况都是我们自己兜底了，认赔。  
A2:退款手续费基本上都是平台兜底了

**Q:如果有优惠的话，怎么退？**  
A:优惠是说满减的退款吗？  
S:活动、优惠劵、或者其他优惠类型。红包。  
A:如果是一百元商品，用了十元优惠券，只能退九十到银行卡

**Q:一个订单号退款一次状态就closed 了么？**  
A:如果部分退款不会  
S:了解，之前问过有赞，商户充值退，用资金池量小也不够  
A:充值退款实际上很不好用，效率低，占压资金  
S:嗯也是，不过也只是一个补充方式。比如交易场景即时到账不走担保交易  
A:是的，比不让退强

**Q:你们没有自己的账户体系吗？比如商户当天的交易款不实时保存在商户临时账户（日终清算用）中吗？为啥要退款前要通道冻结商户款再退款？**  
A:我们有账户体系，每个商户有待结算账户和现金账户，退款先走前者，余额不足走后者  
S:对于退款，你们系统目前做的是前者不足时自动扣商户现金账户？您前面说的通过通道冻结成功后再退款是咋回事？商户有退款银行账户可以用来退款？  
A:冻结和解冻只是从商户的待结算和现金账户扣款时候一个步骤，有的支付公司是商户发起退款就直接从账户下账，返回退款成功，但当发给通道时候，比如通道关闭了或者其他原因退款失败，这笔退款实际没退成，但给商户一个成功，商户和用户就会投诉，反过来，发起退款先发给通道，通道成功再扣商户的钱，那时候商户的结算账户和现金账户都没钱了，支付公司就亏了，所以先在账户冻结这笔钱，通道给了结果再解冻或者扣款是比较公平的方法  
S:严谨。我们就是你说那种，先下账再退款，后续流程是想方设法也要退成，用您上面说的那三种方式。  
A:这样会有客诉，也会容易把这种实际没退完的交易给忘了处理，客诉来了才知道

**Q:通道关了，返回退款失败标志给商户和客户啊，这样不行吗？**  
A1:感知不好。  
情况1、支持直连退款的通道，可能返回退款状态时间不是很快。可你以下账成功为标志，已经返回商户或用户退款成功，等收到明确失败再返回退款失败，感知不好。  
情况2、不支持直连退款的通道，需要人登陆通道服务平台退款，有时间差，同理，已经返回成功，又告诉失败，感知不好。  
S:嗯啦 懂了 系统通知时间异步的问题 谢谢
