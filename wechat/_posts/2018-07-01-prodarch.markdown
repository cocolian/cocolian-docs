---  
layout:     post   
title:      "20180701-账单类类型业务接入支付平台"  
date:       2018-07-01 12:00:00  
author:     "支付产品架构群"  
tag:		[publish] 
description:  今天的主题是第三方支付公司的账单类型的产品接入支付平台，主要用于定期费用交付，比如党费、工会费等。 
--- 


今天的主题是账单类型的产品接入支付平台。    

## 一、产品概述

账单类型的产品接入我们支付中心（如学费，团费等这些类型）。
账单类型的结算模式相对简单，主要为收对应用户的钱，然后定向归集到对应账单所属商户。  
   
目前我们平台能力中心分为支付中心（包装底层能力到业务线），银行能力中心（与银行或者和外围渠道），和清算中心（结算，清分，收费，分润）  
   
![2018-07-01 19:04:38](http://static.cocolian.cn/img/201807/20180701_190438.png) 
   
   
我们业务主要是接入支付中心，账单支付状态与支付中心的实时查询或者通知接口为准，日终进行整体稽核和清算。  
   
   
与银行之间的交易由支付中心提供接口，我们之间对接总账，而商户的清分和结算发起均由业务控制。  
   
   
## 二、开发平台

我们这边开发平台如下：业务开发账单管理后台（账单类型的商户后台，具有审批流，以及与用户特殊相关处理），在线签约平台，商户维护管理后台。     
   
主要步骤：  
1. 建立内部业务类型总过渡户或者总账科目。（我采用的是内部过度户）   
2. 定义账单类型，定义账单唯一标识和商户标识，以便于该账单类型定向结算和清分。  
3. 对接支付平台。支付，代付，退款交易等交易：账单推送到业务平台后，用户可根据账单进行支付（将内部过渡户传到支付），支付平台异步入账到内部过度户。  
4. 日终财务稽核报表。   
5. 监控（付款，退款，交易情况分类型）  
   
## 三、日终报表
   
日终稽核报表如下：  
   
![2018-07-01 19:12:21](http://static.cocolian.cn/img/201807/20180701_191221.png) 
   
   
![2018-07-01 19:12:33](http://static.cocolian.cn/img/201807/20180701_191233.png) 


## 四、Q&A   

   
Q: 账单类型的产品，这个怎么理解？我以为，所有的支付都会有账单  
A：是的。 比如学费，你应交是定死，由对应的管理人员上传。团费，工会费，这些类型  。  
A: 代扣，代付我调用的是底层。至于怎么稽核和商户，我觉得重要点。这个业务不能代扣。  比如像团费，应用户主动交，而非我直接业务平台发起代扣。  我可以底层能力调用银行的代扣：虽然目前关了。     
   
Q: 代扣代缴的业务，银行也有  
A：我想了下，一点点不同吧，我这里指的是需管理员上传账单。且服务费为收支两条线处理的平台。我只需要简单做日终稽核而不需要做账务处理。  
   
Q: 账单类型是交易完成后传到你们的账单产品中心吗，没太懂。  
A： 你可以理解为我接入支付平台，类似于很多公司接入支付宝。他会提供交易查询，交易通知，并提供日终文件。 比如你应该50，实际你付款成功，这个时候，我要实时变更该笔账单状态，否则如果用户又发起这比账单的付款。会导致长款  
   
Q: 很肤浅的问题，这里的账单，不就是订单吗？ 账单类型=订单类型 。我见我一个竞品，它在toC界面，为了用户好理解，叫：我的账单。你这里是账务系统里的账单，由订单中心同步过来的对吧？  
A：我理解为订单是指管理上传后账单后，由我业务平台生成他的支付订单。 因为账单字段与订单字段不一致。  
   
Q: 你们是第三方支付公司的支付系统是吧? 然后类型类型的产品就是对方的业务系统？  
A: 是的，第三方支付公司。 这种应该是带有业务场景的，不是纯支付系统。  
   
Q: 缴费单，充值单，花费单，乱七八糟一堆，不过这些应该是C端触发产生的账单。    
A: 是的。我想和支付核心做个分离，不想过多合并在一起。故使用的标准支付这一套。  
Q: 对的，不能合并。
A: 这里我想说的是，我没有商户系统那么复杂，故没有使用账务的处理模式。这里我使用的是账单统计功能，与需要对应的结算人结合在一起。  
Q：也就是对内使用，不提供商户接入。但是账户体系不影响完备设计。  
A：我拿我现在做的党费来说吧。  我们公司的支付只用于提供我支付使用。至于我怎么接入外围商户，怎么做结算，怎么清分，由我业务平台控制。  而我怎么做的控制就是用的账单。  通过账单与对应结算党委进行绑定，通过统计的方式能够算出应缴，实缴，应结算。 
   
Q: 第三方支付公司做了一个带业务场景的支付系统？  那不就是业务+支付的系统  
A：是的。只是想说的就是业务+支付。只是这个业务类型特殊性在于他的账单。  我并未与我们公司的商户系统合并在一起，以事业部的模式考虑的。  
Q: 还配C端应用？  请问这种系统适用于哪些合作方呀  
A： 需要的。最后用户缴费，需要先查看账单。  合作方有学费，团费，工会费，党费等。  

Q: 支付中心不是这个系统吧？  
A:支付中心是指包装底层能力输出给各业务平台。   比如我业务线就不会对接银行能力中心。  
   
Q: 你们这个系统负责发起支付请求, 还有账单管理?  
A: 是的。支付流水号由我们生成。  
Q: 跟商户的对帐？  
A: 我与支付核心对账。商户我们来处理。我属于两张财务稽核报表，一张是我们支付核心对。 一张是我业务平台算收支对。 

Q: 财务稽核报表是指？  
A: 支付中心只会提供总账给我。首先我要和支付中心对。支付中心今天应该给我清分金额100w，但是我得稽核实际我的内部科目或者内部账户。  
Q： 支付中心只给总账文件对吧，没有明细  ？  
   
Q： 有明细。我们分收支和文件。    
A: 但是是不是一定就是这么多给我，我得去稽核清楚。 我上面发了我们两张表。 还有我和我自己商户的一张报表。    
Q:  T+1 给是吧  ?  
A: 日终。 我们公司收支明细与账务绑定的。就是目前的余额。  而日终文件是与交易订单绑定。  
A: 为什么对账，拿付款来说，我走代付，代付失败了。但是我内部过度户需要等支付中心的财务稽核完毕后，才会退回。这种情况下，不会做通知的。我得去监控和查询。尤其是超过系统轮询期。这个时候就影响我和外围的结算。  

Q:  代付失败的话，支付中心一般隔多久才通知给你呀？退回跟通知不一样吧  ？   
A：  代付失败可以接口查。付款，因为我走的不是超网，我走的银企。  退回实际上可以实时也可以非实时。如果我不走内部过度户的话，走科目的话也可以实时。  不过现在我是非实时内部过度户，非实时。  
Q： 所以对账能解决什么问题呢？    
A: 和钱相关，就要对。当然大部分都是系统对。    
   
Q: 代付走银联通道啊  ， 可以强制结算。不像人行接受到通知就返回成功。   
A：更多的时候，是外围银行账户有问题。    

   
