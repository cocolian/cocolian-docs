---  
layout:     post   
title:      "20180707-二维码支付那些事儿"  
date:       2018-07-07 12:00:00  
author:     "支付产品架构群"  
tag:		[publish] 
description: 嘉宾给大家讲的是二维码支付那些事儿，之所以是“那些事儿”，因为内容并不是说说系统，讲讲业务，而是这几年接触二维码的见与闻。嘉宾从聚合二维码的概念和发展开始，介绍银联是如何努力统一二维码的市场，以及断直联对二维码市场的影响。 

--- 


# 主题分享

今天，我给大家讲的是二维码支付那些事儿，之所以是“那些事儿”，因为内容并不是说说系统，讲讲业务，而是讲讲我这几年接触二维码的见与闻，写的不太细，请各位见谅。

## 一、我和二维码支付前期的接触

我记得，我最早做支付有关系的二维码，是在某股份制银行做本行发码本行支付，为了促进发码的推广，还做了很多营销活动的功能，应该是16年的事儿。    同年的时候银联也看到了二维码支付的市场，推出了自有产品，过程中也不断升级，从原来定位为银联全渠道的产品，进化为独立的二维码支付平台；       
再到后来，二维码专业化前置-二维码支付平台-银联小微-银联AT（后面会简单讲讲这几个系统的来世今生）。
我记得我第一笔二维码支付的交易，应该发生在16年。
同年，我在客户的现场发现了自助售货机。
以前我对这个东西不感冒的，但是16年的时候，我多次到自助售货机购买，因为它可以扫码支付，不用塞钱。     
即使是自助售货机，我发现二维码支付也有两种玩法，
- 一种是我点完商品需要我选择是“微信支付”还是“支付宝支付”。
- 一种是选完商品就弹出一个聚合码，随便你用支付宝还是微信。    

也是我最早看到单码和聚合码的户外玩法。比市场上看到聚合码牌要早几个月（也有可能同行还没有把我生活圈的商户攻克）  
墨迹完我和二维码支付 前期的接触后，我先打算讲讲二维码的概念。主扫、被扫、C2B码、主扫二维码。

## 二、二维码的概念

主扫、被扫、C2B码、主扫二维码。 我说的主扫/被扫，是参考银联的说法的。
主和被，这两个词，主要是讲扣款方（也就是消费者）的。所以在银联没有定义之前，有时候跟别人沟通，还会发生术语上的混乱。

- 主扫支付，就是消费者主动持有扫码设备，扫二维码支付的过程。这个时候的二维码的内容一般是以一种URL的形式。为聚合码的可行性留下个口子。  
- 被扫支付，就是消费者展示自己的二维码，被商户扫一扫。这个时候的二维码（C2B码），一般是一个类似卡号的数字串，而且这个串，有一部分已经被各大机构分了。    

C2B码，前2位，TIN，可以标识发码机构，如：62-银联，目前看到一些不问你用什么支付，直接扫你的二维码的，也就是用这个办法判断的。

## 三、聚合二维码

### 1、聚合二维码概念

聚合二维码，都是主扫二维码，之所以能够产生聚合的效果，是因为它的内容是一个URL。我们手上的支付宝、微信的APP-扫一扫功能，有个特点：  
- 当它扫到的二维码内容是自己style的，如weixin://,那么会调起自己的APP功能。  
- 如果发现二维码的内容是URL，如：http://,APP就会调出APP自带的浏览器，登录http://的地址。所以，我们扫聚合二维码的时候，如果用的是支付宝、微信的APP，其实是跳转到收单机构的收银网关完成支付。  
- 但银联是一个另类。  

### 2、聚合二维码发展史
- 在2017年早期，市场上看到的聚合二维码支持的APP，一般是支付宝、微信，在多一点的就是QQ钱包、京东钱包、百度钱包，但很少见到能够聚合银联。为何？因为银联的二维码支付的规范是交易路径是后台交换的，还没有互联网跳转的玩法。所以2017年推行二维码，即使是银行，也是推支付宝、微信聚合码，银行自发码。     
- 2017年6月2日~8日，银联搞了一次云闪付的活动，让也银联APP热了一把。     
- 2017年7~8月份，银联推出了银联聚合码的规范，把市场上的二维码分类为银联标准码，跟非标码。标准码的style是https://qr.95516.com/机构号/XXXXXXXX，其他都是非标码。    
如果大家要使聚合二维码同时支持银联、支付宝、微信，除国内17家大行，其余请遵守银联标准码的规范，并替换掉已经发的码。于是大家纷纷改银联标准码。

### 3、银联标准码

那银联标准码是怎么实现聚合的效果的呢？秘密还是在URL上。银联标准码的网关地址https://qr.95516.com，银联建设了二维码专业前置。所有流向https://qr.95516.com，二维码专业前置都会根据机构号，forward到收单行的网关。

也就是所交易路径是这样子的：  
- 微信支付宝APP扫：银联标准二维码——银联二维码专业化前置——>银行网关——> 微信/支付宝。  
- 银联系APP扫：银联标准二维码——付款行（发卡行）——>银联二维码支付平台——>收款行（收单行）  

## 四、断直连  

接下来开始断直连，所以，银联推出银联AT（二维码交易处理平台），网联也推出了类似的方案。几个月前建行就先后打广告，对接了银联和网联实现二维码支付。于是，上面1.的这条变成 微信支付宝APP扫：银联标准二维码——银联二维码专业化前置——>银行网关——>银联AT/网联——>微信/支付宝

但是，其实只有银联标准聚合方案，是不够的。因为市场上大多数贴码的，都是小商贩，不满足银联特约商户的要求，所以推出了银联小微。   
小微商户的银联聚合码，都需要由银联小微平台生成，小微商户信息的报送，走小微平台。
于是，变成这样子—发码分类：自发码，银联发码；自发码限制于特约商户，银联发码不限制，但是小微平台发码，只限静态码。

